
            <!-- Set up the Tabs -->
            <input type="radio" class="sheet-tab sheet-tab1" name="attr_core-tab" value="1" title="Basic Info" checked="true"/> 
            <span class="sheet-tab sheet-tab1" style='line-height: 40px;'>CORE INFO</span>
            <input type="radio" class="sheet-tab sheet-tab2" name="attr_core-tab" value="2" title="Skills" /> 
            <span class="sheet-tab sheet-tab2" style='line-height: 40px;'>SKILLS</span>
            <input type="radio" class="sheet-tab sheet-tab3" name="attr_core-tab" value="3" title="Combat" /> 
            <span class="sheet-tab sheet-tab3" style='line-height: 40px;'>COMBAT</span>
            <input type="radio" class="sheet-tab sheet-tab4" name="attr_core-tab" value="4" title="Spells" /> 
            <span class="sheet-tab sheet-tab4" style='line-height: 40px;'>SPELLS</span>
            <input type="radio" class="sheet-tab sheet-tab99" name="attr_core-tab" value="99" title="All" />
            <span class="sheet-tab sheet-tab99" style='line-height: 40px;'>ALL</span>
            <!-- End Tab setup -->


            <div class="sheet-section-core"><!--beginning of core section-->
            <table style="width:100%">
                <tr>
                    <td>

            <table>
                    <tr>
                        <td>
                    <label>Character Name:</label> 
                    <input style=width:150px type="text" name="attr_character_name"/>
                                </td>
                                </tr>
                                    <td>
                    <label>Occupation / Title:</label>
                    <input style=width:150px type="text" name="attr_title"/>
                            </td>
                             </tr>
            </table>

            </td>
            <td>

            <table>
            <tr><td>

            Diety / Religion
            <input style=width:210px type="text" name="attr_religion"/>&nbsp;Psyche <input style=width:210px type="text" name="attr_psyche" value='' /></td></tr>
            <tr><td>Medical <input style=width:250px type="text" name="attr_medical" value=''/></td></tr>

            </td>
            </tr>
            </table>

            </td></tr>
            </table>

            <br>
            <div class="sheet-break"></div>
            <div class="sheet-header">Looks and History</div>
            <table border="1" style="width:100%">
                <tr>
            <td>Gender<input style=width:60px;font-weight:bold type="text" name="attr_Gender"/> </td>
            <td>Race<input style=width:100px;font-weight:bold type="text" name="attr_Race"/> </td>
            <td>Birthdate<br>
                <select name="attr_Month" style="width:80px">
                    <option value="0">Month</option>
                    <option value="1">Nuzyael</option>
                    <option value="2">Peonu</option>
                    <option value="3">Kelen</option>
                    <option value="4">Nolus</option>
                    <option value="5">Larane</option>
                    <option value="6">Agrazhar</option>
                    <option value="7">Azura</option>
                    <option value="8">Halane</option>
                    <option value="9">Savor</option>
                    <option value="10">Ilvin</option>
                    <option value="11">Navek</option>
                    <option value="12">Morgat</option>
                </select>
                <select name="attr_Day" style="width:55px">
                    <option value="0">Day</option>
                    <option value="1">1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5</option>
                    <option value="6">6</option>
                    <option value="7">7</option>
                    <option value="8">8</option>
                    <option value="9">9</option>
                    <option value="10">10</option>
                    <option value="11">11</option>
                    <option value="12">12</option>
                    <option value="13">13</option>
                    <option value="14">14</option>
                    <option value="15">15</option>
                    <option value="16">16</option>
                    <option value="17">17</option>
                    <option value="18">18</option>
                    <option value="19">19</option>
                    <option value="20">20</option>
                    <option value="21">21</option>
                    <option value="22">22</option>
                    <option value="23">23</option>
                    <option value="24">24</option>
                    <option value="25">25</option>
                    <option value="26">26</option>
                    <option value="27">27</option>
                    <option value="28">28</option>
                    <option value="29">29</option>
                    <option value="30">30</option>
                </select>
            </td>
            <td>Sunsign<input style=width:80px;font-weight:bold type="text" name="attr_sunsign" value="@{sunsign_h}" disabled /><input type="hidden" name="attr_sunsign_h" value="" /><input type="hidden" name="attr_sunsigntable_h" value="" /></td>
            <td>Birthplace<input style=width:150px;font-weight:bold type="text" name="attr_Birthplace"/></td> 
            <td>Culture<input style=width:100px;font-weight:bold type="text" name="attr_Culture"/></td> 
            <td>Money<input style=width:60px;font-weight:bold type="text" name="attr_Money"/></td> 
            <td>Age<input style=width:30px;font-weight:bold type="text" name="attr_Age"/></td> 
                        </tr>
            </table>
             <br>       
            <div class="sheet-break"></div>
            <div class="sheet-header">Physical Attributes</div>
                <table border="1" style="width:100%">
                <tr>

                        <td style="font-weight: bold;">Strength<input style=width:30px;font-weight:bold  type="text" name="attr_strength" /><button type='roll' name='roll_skill' value='!HHEML,[[(@{strength}*?{Ease of Challenge|5})-((@{inj_tot_h}*5)+(@{Fatigue}*5)+((round((round((@{armour_wt_h}+@{weapons_tot_h}+@{gen_equip_wt_h}) / round(((@{CS2sb}*@{CS2ml})+@{CS2ug})/5)))/@{ridingwalking}))*5))]],[[1d100,]],skill,Strength Check,Attributes'></button></td>
                        <td style="font-weight: bold;">Stamina<input style=width:30px;font-weight:bold  type="text" name="attr_stamina" /><button type='roll' name='roll_skill' value='!HHEML,[[(@{stamina}*?{Ease of Challenge|5})-((@{inj_tot_h}*5)+(@{Fatigue}*5)+((round((round((@{armour_wt_h}+@{weapons_tot_h}+@{gen_equip_wt_h}) / round(((@{CS2sb}*@{CS2ml})+@{CS2ug})/5)))/@{ridingwalking}))*5))]],[[1d100]],skill,Stamina Check,Attributes'></button></td>
                        <td style="font-weight: bold;">Dexterity<input style=width:30px;font-weight:bold  type="text" name="attr_dexterity" /><button type='roll' name='roll_skill' value='!HHEML,[[(@{dexterity}*?{Ease of Challenge|5})-((@{inj_tot_h}*5)+(@{Fatigue}*5)+((round((round((@{armour_wt_h}+@{weapons_tot_h}+@{gen_equip_wt_h}) / round(((@{CS2sb}*@{CS2ml})+@{CS2ug})/5)))/@{ridingwalking}))*5))]],[[1d100]],skill,Dexterity Check,Attributes'></button></td>
                        <td style="font-weight: bold;">Agility<input style=width:30px;font-weight:bold  type="text" name="attr_agility" /><button type='roll' name='roll_skill' value='!HHEML,[[(@{agility}*?{Ease of Challenge|5})-((@{inj_tot_h}*5)+(@{3}*5)+((round((round((@{armour_wt_h}+@{weapons_tot_h}+@{gen_equip_wt_h}) / round(((@{CS2sb}*@{CS2ml})+@{CS2ug})/5)))/@{ridingwalking}))*5))]],[[1d100]],skill,Agility Check,Attributes'></button></td>
                        <td style="font-weight: bold;">Eyesight<input style=width:30px;font-weight:bold  type="text" name="attr_eyesight" /><button type='roll' name='roll_skill' value='!HHEML,[[(@{eyesight}*?{Ease of Challenge|5})-((@{inj_tot_h}*5)+(@{Fatigue}*5))]],[[1d100]],skill,Eyesight Check,Attributes'></button></td>
                        <td style="font-weight: bold;">Hearing<input style=width:30px;font-weight:bold  type="text" name="attr_hearing" /><button type='roll' name='roll_skill' value='!HHEML,[[(@{hearing}*?{Ease of Challenge|5})-((@{inj_tot_h}*5)+(@{Fatigue}*5))]],[[1d100]],skill,Hearing Check,Attributes'></button></td>
                        <td style="font-weight: bold;">Smell<input style=width:30px;font-weight:bold  type="text" name="attr_smell" /><button type='roll' name='roll_skill' value='!HHEML,[[(@{smell}*?{Ease of Challenge|5})-((@{inj_tot_h}*5)+(@{Fatigue}*5))]],[[1d100]],skill,Smell Check,Attributes'></button></td>
                        <td style="font-weight: bold;">Voice<input style=width:30px;font-weight:bold  type="text" name="attr_voice" /><button type='roll' name='roll_skill' value='!HHEML,[[(@{voice}*?{Ease of Challenge|5})-((@{inj_tot_h}*5)+(@{Fatigue}*5))]],[[1d100,]],skill,Voice Check,Attributes'></button></td>
                    </tr>

                    </table>



            <div class="sheet-break"></div>


            <div class="sheet-header">Personality Attributes</div>
                <table border="1" style="width:100%">
                    <tr>


                            <td style="font-weight: bold;">Intelligence<input style=width:30px;font-weight:bold  type="text" name="attr_intelligence" value='0'/><button type='roll' name='roll_skill' value='!HHEML,[[(@{intelligence}*?{Ease of Challenge|5})-((@{inj_tot_h}+@{Fatigue})*5)]],[[1d100]],skill,Intelligence Check,Attributes'></button></td>
                            <td style="font-weight: bold;">Aura<input style=width:30px;font-weight:bold  type="text" name="attr_aura" value='0'/><button type='roll' name='roll_skill' value='!HHEML,[[(@{aura}*?{Ease of Challenge|5})-((@{inj_tot_h}+@{Fatigue})*5)]],[[1d100]],skill,Aura Check,Attributes'></button></td>
                            <td style="font-weight: bold;">Will<input style=width:30px;font-weight:bold  type="text" name="attr_will" value='0'/><button type='roll' name='roll_skill' value='!HHEML,[[(@{will}*?{Ease of Challenge|5})-((@{inj_tot_h}+@{Fatigue})*5)]],[[1d100]],skill,Will Check,Attributes'></button></td>
                            <td style="font-weight: bold;">CML<input style=width:30px;font-weight:bold  type="text" name="attr_comeliness" value='0'/><button type='roll' name='roll_skill' value='!HHEML,[[(@{comeliness}*?{Ease of Challenge|5})-((@{inj_tot_h}+@{Fatigue})*5)]],[[1d100]],skill,Comeliness Check,Attributes'></button></td>
                            <td style="font-weight: bold;">Morality<input style=width:30px;font-weight:bold  type="text" name="attr_morality" value='0'/><button type='roll' name='roll_skill' value='!HHEML,[[@{morality}*?{Ease of Challenge|5}]],[[1d100]],skill,Morality Check,Attributes'></button></td>
                            <td style="font-weight: bold;">Piety<input style=width:30px;font-weight:bold  type="text" name="attr_piety" value='0'/><button type='roll' name='roll_skill' value='/me EML [[@{piety}*?{Ease of Challenge|5}]]: rolls [[1d100cs5cs10cs15cs20cs25cs30cs35cs40cs45cs50cs55cs60cs65cs70cs75cs80cs85cs90cs95cs100]] Piety skill.'></button></td>
                            <td style="font-weight: bold;">Clerical<input style=width:30px;font-weight:bold  type="text" name="attr_Clerical" /><button type='roll' name='roll_skill' value='/me EML [[@{Clerical}*?{Ease of Challenge|5}]]: rolls [[1d100cs5cs10cs15cs20cs25cs30cs35cs40cs45cs50cs55cs60cs65cs70cs75cs80cs85cs90cs95cs100]] Clerical skill.'></button></td>
                            

                    
                            
                        </td></tr>
                </table>
            <div class="sheet-break"></div>

                  <div class="sheet-header">Appearance</div>
                <table border="1" style="width:100%">
                    <tr>
                        <td>Height<input style=width:40px type="text" name="attr_height" value='0'/></td>
                
                        <td>Frame<input style=width:40px type="text" name="attr_frame" value='0'/></td>
                
                        <td>Weight<input style=width:40px type="text" name="attr_weight" value='0'/></td>
                    
                        <td>Size<select name="attr_bodysize" style="width:40px"><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6" selected>6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></td>
                      
                        <td>Other Appearence<input style=width:260px type="text" name="attr_other_appearence" value='0'/></td>
                          <td>        Notes
                        <input style=width:260px type="text" name="attr_notes"/></td>

                       </tr>
                </table>
                 <br>
             <div class="sheet-break"></div>
             <div class="sheet-header">Attribute tests</div>
                <table border="1" style="width:100%">
                <tr>

                        <td style="font-weight: bold;">Carrying<button type='roll' name='roll_skill' value='!HHEML,[[round((@{strength}+@{stamina}+@{will}) / 3)-(@{P4})]],[[1d100]],skill,Carrying Test,Attributes'></button></td>
                        <td style="font-weight: bold;">Dodge <<input style=width:35px;font-weight:bold;color:#0000ff;text-align:center  type="text" name="attr_Initiative" value='[[(@{agility}*5)-(@{P4})]]' disabled=true>> <button type='roll' name='roll_skill' value='!HHEML,[[(@{agility}*5)-(@{P4})]],[[1d100]],skill,Dodge Test,Attributes'></button></td>
                        <td style="font-weight: bold;">Fumble/Grope<button type='roll' name='roll_skill' value='!HHEML,[[(@{dexterity}*5)-((@{inj_tot_h}*5)+(@{Fatigue}*5))]],[[1d100]],skill,Fumble/Grope Test,Attributes'></button></td>
                        <td style="font-weight: bold;">Lifting<button type='roll' name='roll_skill' value='!HHEML,[[(@{strength}*5)-(@{P4})]],[[1d100]],skill,Lifting Test,Attributes'></button></td>
                        <td style="font-weight: bold;">Listening<button type='roll' name='roll_skill' value='!HHEML,[[@{hearing}*?{Ease of Challenge|5}]],[[1d100]],skill,Listening Test,Attributes'></button></td>
                </tr>
                <tr>
                        <td style="font-weight: bold;">Shock Roll<button type='roll' name='roll_skill' value="!HHEML,[[round(((@{CS2sb}*@{CS2ml})+@{CS2ug})/5)]],[[(@{inj_tot_h}+@{Fatigue})d6]],skill,Shock Roll Test,Attributes"></button></td>

                        <td style="font-weight: bold;">Stumble<button type='roll' name='roll_skill' value='!HHEML,[[(@{agility}*5)-((@{inj_tot_h}*5)+(@{Fatigue}*5))]],[[1d100]],skill,Stumble Test,Attributes'></button></td>
                       
                       <td style="font-weight: bold;">Initiative<input style=width:35px  type="text" name="attr_Initiative" value='[[round((@{agility}+@{will}+@{will}) / 3)*@{IML}]]' disabled /> ML<input style=width:35px  type="text" name="attr_IML" value='1'/> XP<input style=width:24px  type="text" name="attr_IUG" value='0'/> <<input style=width:35px;font-weight:bold;color:#0000ff;text-align:center;  type="text" name="attr_tot-initiative" value='[[(round((@{agility}+@{will}+@{will}) / 3)*@{IML})+@{IUG}-(@{P4})-(?{Other modifiers?|0})]]' disabled>> <button type='roll' name='roll_skill' value='!HHEML,@{tot-initiative},[[1d100 &{tracker}]],skill,Initiative Test,Attributes'></button></td>
                       
                       
                       <td style="font-weight: bold;">Endurance<input style=width:30px;font-weight:bold  type="text" name="attr_Endurance" value='round((@{strength}+@{stamina}+@{will}) / 3)' disabled/><button type='roll' name='roll_skill' value='!HHEML,[[round((@{strength}+@{stamina}+@{will}) / 3)*?{EML|5}]],[[1d100]],skill,Endurance test,Attributes'></button></td>
                        <td>Move<input style=width:30px  type="text" name="attr_Move" value='0'/><button type='roll' name='roll_skill' value='!HHEML,[[@{Move}*?{Ease of Challenge|5}]],[[1d100]],skill,Move Test,Attributes'></button></td>
                </tr>
                </table>

                    <div class="sheet-break"></div>

                                     <div class="sheet-header">Penalties & Load</div>
                             
                         

                         <table border="1" style="width:100%">
                     
                                      <tr>
                                      
                <td>Armour Weight<input style=width:35px type="text" name="attr_armour_weight" value='@{armour_wt_h}' disabled="true"/>
                    Weapon Weight<input style=width:35px type="text" name="attr_weapon_weight" value='@{weapons_tot_h}' disabled="true"/>
                    Other Items Weight<input style=width:35px  type="text" name="attr_other_weight" value='@{gen_equip_wt_h}' disabled="true"/>
                    Total Weight<input style=width:35px type="text" name="attr_invwt" value='@{armour_weight}+@{weapon_weight}+@{other_weight}' disabled="true"/>
                    &nbsp;Riding <input type="radio" name="attr_ridingwalking" value="2" style="width:30px" />&nbsp;Walking <input type="radio" name="attr_ridingwalking" value="1" style="width:30px" checked="true" />
                     </td>                    
            </tr><tr>  
                <td>Injury Levels<input style=width:35px type="text" name="attr_Injury" value='@{inj_tot_h}' disabled="true"/>&nbsp;Bloodloss<input style=width:50px  type="text" name="attr_InjuriesBL" value="0" />&nbsp;Fatigue Levels<input style=width:35px type="text" name="attr_Fatigue" value='0'/>&nbsp;Universal Penalty<input style=width:35px type="text" name="attr_P1" value='[[@{Injury}+@{Fatigue}]]' disabled/>&nbsp;&nbsp;Healing Roll<button type='roll' name='roll_skill' value="!HHEML,[[(@{stamina}*?{Healing Level|5})+?{Modifiers|0}]],[[1d100]],skill,Healing Roll Test,Attributes"></button>
               </td>
            </tr><tr>  
                <td style="font-weight:bold">
                Encumbrance<input style=width:35px  type="text" name="attr_Encumbrance" value='round((round((@{armour_weight}+@{weapon_weight}+@{other_weight}) / round(((@{CS2sb}*@{CS2ml})+@{CS2ug})/5)))/@{ridingwalking})' disabled/>&nbsp;
                Physical Penalty<input style=width:35px type="text" name="attr_P3" value='@{inj_tot_h}+@{Fatigue}+@{Encumbrance}' disabled/>
                &nbsp;Non-Physical EML Penalty<input style=width:35px type="text" name="attr_P2" value='(@{inj_tot_h}*5)+(@{Fatigue}*5)' disabled/>
                &nbsp;Final Physical EML Penalty<input style=width:35px type="text" name="attr_P4" value='(@{inj_tot_h}*5)+(@{Fatigue}*5)+((round((round((@{armour_weight}+@{weapon_weight}+@{other_weight}) / round(((@{CS2sb}*@{CS2ml})+@{CS2ug})/5)))/@{ridingwalking}))*5)' disabled/>
            </td>
                 </tr>
                </table>
                <br>

        <input type="hidden" name="attr_inj_tot_h" value="0">

        <input type="hidden" name="attr_gen_equip_wt_h" value="0">

                      <div class="sheet-header">General Equipment</div>
                      <div class="sheet-repitem">
                    <fieldset class="repeating_equipment">
                        <table border="1" style="width:100%">
                        <tr>
                            <td>
                        <input style=width:650px type="text" name="attr_gen_equip"/></td><td>&nbsp;WT<input type="text" name="attr_item_weight" value="0" style="width:40px;text-align:center"><input type="hidden" name="attr_item_wt" value="0"></td><td style="width:100px;text-align:center">E<input style=width:15px type="radio" name="attr_item_equipped" value='e' title="Equipped/Carried" checked="true"/>&nbsp;N<input style=width:15px type="radio" name="attr_item_equipped" value='n' title="Non equipped"/></td>
                         </tr>
                    </table>
                    </fieldset>
                  </div>

        </div><!--end section core-->


        <div class="sheet-section-skills"><!--beginning of skills section-->
            
                

                
            
             <div class="sheet-break"></div>
                <div class="sheet-header">Combat Skills</div>
                   <div class="sheet-skills">
                   <table border="1" style="width:100%">
                     <tr>
                        <table style="width=800px">
                            <tr>
                                <td align=center>skill name</td><td align=center>SB</td><td align=center>SS</td><td align=center>ML</td><td align=center>XP</td><td align=center>EML</td><td></td><td align=center>skill name</td><td align=center>SB</td><td align=center>SS</td><td align=center>ML</td><td align=center>XP</td><td align=center>EML</td><td></td>
                            </tr>
                            <tr>
                                <td style="width:220px;text-align:right;font-weight:bold">Condition&nbsp;(<input style=width:30px  type="text" name="attr_condition_tot" value='[[(((@{CS2sb}+@{CS2ss})*@{CS2ml})+@{CS2ug})]]' disabled="true" />)&nbsp;</td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_CS2sb" value='round((@{strength}+@{stamina}+@{will}) / 3)' disabled/></td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_CS2ss" value='[[@{CS2ss_h}]]' disabled/><input type="hidden" name="attr_CS2ss_h" value='0'/></td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_CS2ml" value='5' /></td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_CS2ug" value='0' /></td>
                                <td style="width:35px"><input style=width:35px;color:#0000ff;text-align:center;  type="text" name="attr_tot-condition" value='[[@{condition_tot}-(@{P4})+?{EML|0}]]' disabled="true"/></td>
                                <td style="width:35px"><button type='roll' name='roll_skill' value='!HHEML,@{tot-condition},[[1d100]],skill,Condition,Combat Skills'></button></td>
                            
                                <td style="width:220px;text-align:right;font-weight:bold">Riding&nbsp;(<input style=width:30px  type="text" name="attr_riding_tot" value='[[(((@{CS3sb}+@{CS3ss})*@{CS3ml})+@{CS3ug})]]' disabled="true"/>)&nbsp;</td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_CS3sb"  value='round((@{strength}+@{will}+@{agility}) / 3)'/></td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_CS3ss" value='[[@{CS3ss_h}]]' disabled/><input type="hidden" name="attr_CS3ss_h" value='0'/></td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_CS3ml"  value='0'/></td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_CS3ug" value='0' /></td>
                                <td style="width:35px"><input style=width:35px;color:#0000ff;text-align:center;  type="text" name="attr_tot-riding" value='@{riding_tot}-((@{Encumbrance}*5))-(@{P1}*5)+?{EML|0}' disabled="true"/></td>
                                <td style="width:35px"><!button type='roll' name='roll_skill' value='!HHEML,@{tot-riding},[[1d100]],Riding,Combat Skills'></button></td>
                            </tr>
                        </table>
                            <div class="sheet-repitem">
                             <fieldset class="repeating_combat">
                        <table style="width=800px">
                            <tr>
                                <td style="width:220px;text-align:right"><input style=width:150px;text-align:right;font-weight:bold type="text" name="attr_cs4"/>&nbsp;(<input style=width:30px  type="text" name="attr_cs4_tot" value='[[(((@{cs4sb}+@{cs4ss})*@{cs4ml})+@{cs4ug})]]' disabled="true"/>)&nbsp;</td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_cs4sb" value='0'/></td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_cs4ss" value='[[@{cs4ss_h}]]' disabled="true"/><input type="hidden" name="attr_cs4ss_h" value='0'/></td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_cs4ml" value='0'/></td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_cs4ug" value='0'/></td>
                                <td style="width:35px"><input style=width:35px;color:#0000ff;text-align:center;  type="text" name="attr_tot-cs4" value='@{cs4_tot}-(@{P4})+?{EML|0}' disabled="true"/></td>
                                <td style="width:35px"><button type='roll' name='roll_skill' value='!HHEML,@{tot-cs4},[[1d100]],skill,@{cs4},Combat Skills'></button></td>
                            
                                <td style="width:220px;text-align:right"><input style=width:150px;text-align:right;font-weight:bold type="text" name="attr_cs5"/>&nbsp;(<input style=width:30px  type="text" name="attr_cs5_tot" value='[[(((@{cs5sb}+@{cs5ss})*@{cs5ml})+@{cs5ug})]]' disabled="true"/>)&nbsp;</td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_cs5sb" value='0'/></td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_cs5ss" value='[[@{cs5ss_h}]]' disabled="true"/><input type="hidden" name="attr_cs5ss_h" value='0'/></td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_cs5ml" value='0'/></td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_cs5ug" value='0'/></td>
                                <td style="width:35px"><input style=width:35px;color:#0000ff;text-align:center;  type="text" name="attr_tot-cs5" value='@{cs5_tot}-(@{P4})+?{EML|0}' disabled="true"/></td>
                                <td style="width:35px"><button type='roll' name='roll_skill' value='!HHEML,@{tot-cs5},[[1d100]],skill,@{cs5},Combat Skills'></button></td>
                            </tr>

                        </table>
                        </fieldset>
                        </div>

                   </tr>
                </table>
            </div>
                
            <div class="sheet-break"></div>
                <div class="sheet-header">Physical Skills</div>
                    <div class="sheet-skills">
                   <table border="1" style="width:100%">
                     <tr>
                        <table style="width=800px">
                            <tr>
                                <td align=center>skill name</td><td align=center>SB</td><td align=center>SS</td><td align=center>ML</td><td align=center>XP</td><td align=center>EML</td><td></td><td align=center>skill name</td><td align=center>SB</td><td align=center>SS</td><td align=center>ML</td><td align=center>XP</td><td align=center>EML</td><td></td>
                            </tr>
                            <tr>
                                <td style="width:220px;text-align:right;font-weight:bold">Climbing&nbsp;(<input style=width:30px  type="text" name="attr_climbing_tot" value='[[(((round((@{strength}+@{dexterity}+@{agility}) / 3)+@{climbingss_h})*@{climbingml})+@{climbingug})]]' disabled="true"/>)&nbsp;</td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_climbingsb" value='round((@{strength}+@{dexterity}+@{agility}) / 3)' disabled="true"/></td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_climbingss" value='[[@{climbingss_h}]]' disabled/><input type="hidden" name="attr_climbingss_h" value='0'/></td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_climbingml" value='0'/></td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_climbingug" value='0' /></td>
                                <td style="width:35px"><input style=width:35px;color:#0000ff;text-align:center;  type="text" name="attr_tot-climbing" value='[[@{climbing_tot}-(@{P4})+?{EML|0}]]' disabled="true"/></td>
                                <td style="width:35px"><button type='roll' name='roll_skill' value='!HHEML,@{tot-climbing},[[1d100]],skill,Climbing,Physical Skills'></button></td>
                            
                                <td style="width:220px;text-align:right;font-weight:bold">Jumping&nbsp;(<input style=width:30px  type="text" name="attr_jumping_tot" value='[[(((round((@{strength}+@{agility}+@{agility}) / 3)+@{jumpingss_h})*@{jumpingml})+@{jumpingug})]]' disabled="true"/>)&nbsp;</td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_jumpingsb" value='round((@{strength}+@{agility}+@{agility}) / 3)' disabled="true"/></td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_jumpingss" value='[[@{jumpingss_h}]]' disabled/><input type="hidden" name="attr_jumpingss_h" value='0'/></td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_jumpingml" value='0'/></td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_jumpingug" value='0'/></td>
                                <td style="width:35px"><input style=width:35px;color:#0000ff;text-align:center;  type="text" name="attr_tot-jumping" value='[[@{jumping_tot}-(@{P4})+?{EML|0}]]' disabled="true"/></td>
                                <td style="width:35px"><button type='roll' name='roll_skill' value='!HHEML,@{tot-jumping},[[1d100]],skill,Jumping,Physical Skills'></button></td>
                            </tr>
                            <tr>
                                <td style="width:220px;text-align:right;font-weight:bold">Stealth&nbsp;(<input style=width:30px  type="text" name="attr_stealth_tot" value='[[(((round((@{will}+@{hearing}+@{agility}) / 3)+@{stealthss_h})*@{stealthml})+@{stealthug})]]' disabled="true"/>)&nbsp;</td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_stealthsb" value='round((@{will}+@{hearing}+@{agility}) / 3)' disabled="true"/></td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_stealthss" value='[[@{stealthss_h}]]' disabled/><input type="hidden" name="attr_stealthss_h" value='0'/></td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_stealthml" value='0'/></td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_stealthug" value='0'/></td>
                                <td style="width:35px"><input style=width:35px;color:#0000ff;text-align:center;  type="text" name="attr_tot-stealth" value='[[@{stealth_tot}-(@{P4})+?{EML|0}]]' disabled="true"/></td>
                                <td style="width:35px"><button type='roll' name='roll_skill' value='!HHEML,@{tot-stealth},[[1d100]],skill,Stealth,Physical Skills'></button></td>
                            
                                <td style="width:220px;text-align:right;font-weight:bold">Throwing&nbsp;(<input style=width:30px  type="text" name="attr_throwing_tot" value='[[(((round((@{strength}+@{dexterity}+@{eyesight}) / 3)+@{throwingss_h})*@{tml})+@{txp})]]' disabled="true"/>)&nbsp;</td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_tsb" value='round((@{strength}+@{dexterity}+@{eyesight}) / 3)' disabled="true"/></td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_throwingss" value='[[@{throwingss_h}]]' disabled/><input type="hidden" name="attr_throwingss_h" value='0'/></td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_tml" value='0'/></td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_txp" value='0'/></td>
                                <td style="width:35px"><input style=width:35px;color:#0000ff;text-align:center;  type="text" name="attr_tot-t" value='[[@{throwing_tot}-(@{P4})+?{EML|0}]]' disabled="true"/></td>
                                <td style="width:35px"><button type='roll' name='roll_skill' value='!HHEML,@{tot-t},[[1d100]],skill,Throwing,Physical Skills'></button></td>
                            </tr>
                        </table>
                            <div class="sheet-repitem">
                             <fieldset class="repeating_physical">
                        <table style="width=800px">
                            <tr>
                                <td style="width:220px;text-align:right"><input style=width:150px;text-align:right;font-weight:bold type="text" name="attr_ps1"/>&nbsp;(<input style=width:30px  type="text" name="attr_ps1_tot" value='[[(((@{ps1sb}+@{ps1ss})*@{ps1ml})+@{ps1ug})]]' disabled="true"/>)&nbsp;</td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_ps1sb" value='0'/></td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_ps1ss" value='[[@{ps1ss_h}]]' disabled/><input type="hidden" name="attr_ps1ss_h" value='0'/>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_ps1ml" value='0'/></td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_ps1ug" value='0'/></td>
                                <td style="width:35px"><input style=width:35px;color:#0000ff;text-align:center;  type="text" name="attr_tot-ps1" value='[[@{ps1_tot}-(@{P4})+?{EML|0}]]' disabled="true"/></td>
                                <td style="width:35px"><button type='roll' name='roll_skill' value='!HHEML,@{tot-ps1},[[1d100]],skill,@{ps1},Physical Skills'></button></td>
                            
                                <td style="width:220px;text-align:right"><input style=width:150px;text-align:right;font-weight:bold type="text" name="attr_ps2"/>&nbsp;(<input style=width:30px  type="text" name="attr_ps2_tot" value='[[(((@{ps2sb}+@{ps2ss})*@{ps2ml})+@{ps2ug})]]' disabled="true"/>)&nbsp;</td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_ps2sb" value='0'/></td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_ps2ss" value='[[@{ps2ss_h}]]' disabled/><input type="hidden" name="attr_ps2ss_h" value='0'/>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_ps2ml" value='0'/></td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_ps2ug" value='0'/></td>
                                <td style="width:35px"><input style=width:35px;color:#0000ff;text-align:center;  type="text" name="attr_tot-ps2" value='[[@{ps2_tot}-(@{P4})+?{EML|0}]]' disabled="true"/></td>
                                <td style="width:35px"><button type='roll' name='roll_skill' value='!HHEML,@{tot-ps2},[[1d100]],skill,@{ps2},Physical Skills'></button></td>
                            </tr>

                        </table>
                        </fieldset>
                        </div>

                   </tr>
                </table>
                </div>

                <div class="sheet-break"></div>
                <div class="sheet-header">Communication Skills</div>

                <div class="sheet-skills">
                   <table border="1" style="width:100%">
                     <tr>
                        <table style="width=800px">
                            <tr>
                                <td align=center>skill name</td><td align=center>SB</td><td align=center>SS</td><td align=center>ML</td><td align=center>XP</td><td align=center>EML</td><td></td><td align=center>skill name</td><td align=center>SB</td><td align=center>SS</td><td align=center>ML</td><td align=center>XP</td><td align=center>EML</td><td></td>
                            </tr>
                            <tr>
                                <td style="width:220px;text-align:right;font-weight:bold">Awareness&nbsp;(<input style=width:30px  type="text" name="attr_awareness_tot" value='[[(((round((@{eyesight}+@{hearing}+@{smell}) / 3)+@{awarenessss_h})*@{awarenessml})+@{awarenessug})]]' disabled="true"/>)&nbsp;</td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_awarenesssb" value='round((@{eyesight}+@{hearing}+@{smell}) / 3)' disabled="true"/></td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_awarenessss" value='[[@{awarenessss_h}]]' disabled/><input type="hidden" name="attr_awarenessss_h" value='0'/></td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_awarenessml" value='0'/></td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_awarenessug" value='0' /></td>
                                <td style="width:35px"><input style=width:35px;color:#0000ff;text-align:center;  type="text" name="attr_tot-awareness" value='[[@{awareness_tot}-(@{P2})+?{EML|0}]]' disabled="true"/></td>
                                <td style="width:35px"><button type='roll' name='roll_skill' value='!HHEML,@{tot-awareness},[[1d100]],skill,Awareness,Communication Skills'></button></td>
                            
                                <td style="width:220px;text-align:right;font-weight:bold">Intrigue&nbsp;(<input style=width:30px  type="text" name="attr_intrigue_tot" value='[[(((round((@{will}+@{aura}+@{intelligence}) / 3)+@{intriguess_h})*@{Intrigueml})+@{Intrigueug})]]' disabled="true"/>)&nbsp;</td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_Intriguesb" value='round((@{will}+@{aura}+@{intelligence}) / 3)' disabled="true"/></td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_intriguess" value='[[@{intriguess_h}]]' disabled/><input type="hidden" name="attr_intriguess_h" value='0'/></td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_Intrigueml" value='0'/></td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_Intrigueug" value='0'/></td>
                                <td style="width:35px"><input style=width:35px;color:#0000ff;text-align:center;  type="text" name="attr_tot-Intrigue" value='[[@{intrigue_tot}-(@{P2})+?{EML|0}]]' disabled="true"/></td>
                                <td style="width:35px"><button type='roll' name='roll_skill' value='!HHEML,@{tot-Intrigue},[[1d100]],skill,Intrigue,Communication Skills'></button></td>
                            </tr>
                            <tr>
                                <td style="width:220px;text-align:right;font-weight:bold">Oratory&nbsp;(<input style=width:30px  type="text" name="attr_oratory_tot" value='[[(((round((@{intelligence}+@{voice}+@{comeliness}) / 3)+@{oratoryss_h})*@{Oratoryml})+@{Oratoryug})]]' disabled="true"/>)&nbsp;</td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_Oratorysb" value='round((@{intelligence}+@{voice}+@{comeliness}) / 3)' disabled="true"/></td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_oratoryss" value='[[@{oratoryss_h}]]' disabled/><input type="hidden" name="attr_oratoryss_h" value='0'/></td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_Oratoryml" value='0'/></td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_Oratoryug" value='0'/></td>
                                <td style="width:35px"><input style=width:35px;color:#0000ff;text-align:center;  type="text" name="attr_tot-Oratory" value='[[@{oratory_tot}-(@{P2})+?{EML|0}]]' disabled="true"/></td>
                                <td style="width:35px"><button type='roll' name='roll_skill' value='!HHEML,@{tot-Oratory},[[1d100]],skill,Oratory,Communication Skills'></button></td>
                            
                                <td style="width:220px;text-align:right;font-weight:bold">Rhetoric&nbsp;(<input style=width:30px  type="text" name="attr_rhetoric_tot" value='[[(((round((@{will}+@{voice}+@{intelligence}) / 3)+@{rhetoricss_h})*@{Rhetoricml})+@{Rhetoricxp})]]' disabled="true"/>)&nbsp;</td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_Rhetoricsb" value='round((@{will}+@{voice}+@{intelligence}) / 3)' disabled="true"/></td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_rhetoricss" value='[[@{rhetoricss_h}]]' disabled/><input type="hidden" name="attr_rhetoricss_h" value='0'/></td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_Rhetoricml" value='0'/></td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_Rhetoricxp" value='0'/></td>
                                <td style="width:35px"><input style=width:35px;color:#0000ff;text-align:center;  type="text" name="attr_tot-Rhetoric" value='[[@{rhetoric_tot}-(@{P2})+?{EML|0}]]' disabled="true"/></td>
                                <td style="width:35px"><button type='roll' name='roll_skill' value='!HHEML,@{tot-Rhetoric},[[1d100]],skill,Rhetoric,Communication Skills'></button></td>
                            </tr>
                             <tr>
                                <td style="width:220px;text-align:right;font-weight:bold">Ritual&nbsp;<input style=width:100px;text-align:right;font-weight:bold type="text" name="attr_rtl"/>&nbsp;(<input style=width:30px  type="text" name="attr_ritual_tot" value='[[(((@{Ritualsb}+@{ritualss_h})*@{Ritualml})+@{Ritualug})]]' disabled="true"/>)&nbsp;</td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_Ritualsb" value='0'/><input type="hidden" name="attr_ritualss_h" value='0'/></td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_ritualss" value='[[@{ritualss_h}]]' disabled="true"/></td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_Ritualml" value='0'/></td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_Ritualug" value='[[@{shpv8ug}]]' disabled="true"/></td>
                                <td style="width:35px"><input style=width:35px;color:#0000ff;text-align:center;  type="text" name="attr_tot-Ritual" value='[[(((@{Ritualsb}+@{ritualss})*@{Ritualml})+@{Ritualug})-(@{P2})+?{EML|0}]]' disabled="true"/></td>
                                <td style="width:35px"><button type='roll' name='roll_skill' value='!HHEML,@{tot-Ritual},[[1d100]],skill,Ritual,Communication Skills'></button></td>
                            
                                <td style="width:220px;text-align:right;font-weight:bold">Singing&nbsp;(<input style=width:30px  type="text" name="attr_singing_tot" value='[[(((round((@{hearing}+@{voice}+@{voice}) / 3)+@{singingss_h})*@{Singingml})+@{Singingxp})]]' disabled="true"/>)&nbsp;</td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_Singingsb" value='round((@{hearing}+@{voice}+@{voice}) / 3)' disabled="true"/></td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_singingss" value='[[@{singingss_h}]]' disabled/><input type="hidden" name="attr_singingss_h" value='0'/></td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_Singingml" value='0'/></td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_Singingxp" value='0'/></td>
                                <td style="width:35px"><input style=width:35px;color:#0000ff;text-align:center;  type="text" name="attr_tot-Singing" value='[[(((@{Singingsb}+@{singingss})*@{Singingml})+@{Singingxp})-(@{P2})+?{EML|0}]]' disabled="true"/></td>
                                <td style="width:35px"><button type='roll' name='roll_skill' value='!HHEML,@{tot-Singing},[[1d100]],skill,Singing,Communication Skills'></button></td>
                            </tr>
                        </table>
                            <div class="sheet-repitem">
                             <fieldset class="repeating_communication">
                        <table style="width=800px">
                            <tr>
                                <td style="width:220px;text-align:right"><input style=width:150px;text-align:right;font-weight:bold type="text" name="attr_comm1"/>&nbsp;(<input style=width:30px  type="text" name="attr_comm1_tot" value='[[(((@{comm1sb}+@{comm1ss})*@{comm1ml})+@{comm1ug})]]' disabled="true"/>)&nbsp;</td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_comm1sb" value='0'/></td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_comm1ss" value='[[@{comm1ss_h}]]' disabled/><input type="hidden" name="attr_comm1ss_h" value='0'/>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_comm1ml" value='0'/></td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_comm1ug" value='0'/></td>
                                <td style="width:35px"><input style=width:35px;color:#0000ff;text-align:center;  type="text" name="attr_tot-comm1" value='[[((@{comm1sb}*@{comm1ml})+@{comm1ug})-(@{P2})+?{EML|0}]]' disabled="true"/></td>
                                <td style="width:35px"><button type='roll' name='roll_skill' value='!HHEML,@{tot-comm1},[[1d100]],skill,@{comm1},Communication Skills'></button></td>
                            
                                <td style="width:220px;text-align:right"><input style=width:150px;text-align:right;font-weight:bold type="text" name="attr_comm2"/>&nbsp;(<input style=width:30px  type="text" name="attr_comm2_tot" value='[[(((@{comm2sb}+@{comm2ss})*@{comm2ml})+@{comm2ug})]]' disabled="true"/>)&nbsp;</td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_comm2sb" value='0'/></td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_comm2ss" value='[[@{comm2ss_h}]]' disabled/><input type="hidden" name="attr_comm2ss_h" value='0'/>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_comm2ml" value='0'/></td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_comm2ug" value='0'/></td>
                                <td style="width:35px"><input style=width:35px;color:#0000ff;text-align:center;  type="text" name="attr_tot-comm2" value='[[((@{comm2sb}*@{comm2ml})+@{comm2ug})-(@{P2})+?{EML|0}]]' disabled="true"/></td>
                                <td style="width:35px"><button type='roll' name='roll_skill' value='!HHEML,@{tot-comm2},[[1d100]],skill,@{comm2},Communication Skills'></button></td>
                            </tr>

                        </table>
                        </fieldset>
                        </div>

                   </tr>
                </table>
                </div>



                    <div class="sheet-break"></div>
                <div class="sheet-header">Craft/Lore Skills</div>

                       <div class="sheet-skills">
                   <table border="1" style="width:100%">
                     <tr>
                            <table style="width=800px">
                            <tr>
                                <td align=center>skill name</td><td align=center>SB</td><td align=center>SS</td><td align=center>ML</td><td align=center>XP</td><td align=center>EML</td><td></td><td align=center>skill name</td><td align=center>SB</td><td align=center>SS</td><td align=center>ML</td><td align=center>XP</td><td align=center>EML</td><td></td>
                            </tr>
                            <tr>
                                <td style="width:220px;text-align:right;font-weight:bold"><input style=width:150px;text-align:right;font-weight:bold type="text" name="attr_crafta"/>&nbsp;(<input style=width:30px  type="text" name="attr_crafta_tot" value='[[(((@{craftasb}+@{craftass})*@{craftaml})+@{craftaug})]]' disabled="true"/>)&nbsp;</td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_craftasb" value='0'/></td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_craftass" value='[[@{craftass_h}]]' disabled/><input type="hidden" name="attr_craftass_h" value='0'/></td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_craftaml" value='0'/></td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_craftaug" value='0' /></td>
                                <td style="width:35px"><input style=width:35px;color:#0000ff;text-align:center;  type="text" name="attr_tot-crafta" value='[[(((@{craftasb}+@{craftass})*@{craftaml})+@{craftaug})-(@{P2})+?{EML|0}]]' disabled="true"/></td>
                                <td style="width:35px"><button type='roll' name='roll_skill' value='!HHEML,@{tot-crafta},[[1d100]],skill,@{crafta},Communication Skills'></button></td>
                            
                                <td style="width:220px;text-align:right;font-weight:bold"><input style=width:150px;text-align:right;font-weight:bold type="text" name="attr_craftb"/>&nbsp;(<input style=width:30px  type="text" name="attr_craftb_tot" value='[[(((@{craftbsb}+@{craftbss})*@{craftbml})+@{craftbug})]]' disabled="true"/>)&nbsp;</td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_craftbsb" value='0'/></td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_craftbss" value='[[@{craftbss_h}]]' disabled/><input type="hidden" name="attr_craftbss_h" value='0'/></td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_craftbml" value='0'/></td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_craftbug" value='0'/></td>
                                <td style="width:35px"><input style=width:35px;color:#0000ff;text-align:center;  type="text" name="attr_tot-craftb" value='[[(((@{craftbsb}+@{craftbss})*@{craftbml})+@{craftbug})-(@{P2})+?{EML|0}]]' disabled="true"/></td>
                                <td style="width:35px"><button type='roll' name='roll_skill' value='!HHEML,@{tot-craftb},[[1d100]],skill,@{craftb},Communication Skills'></button></td>
                            </tr>
                            </table>
                            <div class="sheet-repitem">
                             <fieldset class="repeating_craft">
                        <table style="width=800px">
                            <tr>
                                <td style="width:220px;text-align:right"><input style=width:150px;text-align:right;font-weight:bold type="text" name="attr_craft1"/>&nbsp;(<input style=width:30px  type="text" name="attr_craft1_tot" value='[[(((@{craft1sb}+@{craft1ss})*@{craft1ml})+@{craft1ug})]]' disabled="true"/>)&nbsp;</td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_craft1sb" value='0'/></td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_craft1ss" value='[[@{craft1ss_h}]]' disabled/><input type="hidden" name="attr_craft1ss_h" value='0'/></td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_craft1ml" value='0'/></td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_craft1ug" value='0'/></td>
                                <td style="width:35px"><input style=width:35px;color:#0000ff;text-align:center;  type="text" name="attr_tot-craft1" value='[[(((@{craft1sb}+@{craft1ss})*@{craft1ml})+@{craft1ug})-(@{P2})]]' disabled="true"/></td>
                                <td style="width:35px"><button type='roll' name='roll_skill' value='!HHEML,@{tot-craft1}+?{EML|0},[[1d100]],skill,@{craft1},Communication Skills'></button></td>
                            
                                <td style="width:220px;text-align:right"><input style=width:150px;text-align:right;font-weight:bold type="text" name="attr_craft2"/>&nbsp;(<input style=width:30px  type="text" name="attr_craft2_tot" value='[[(((@{craft2sb}+@{craft2ss})*@{craft2ml})+@{craft2ug})]]' disabled="true"/>)&nbsp;</td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_craft2sb" value='0'/></td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_craft2ss" value='[[@{craft2ss_h}]]' disabled/><input type="hidden" name="attr_craft2ss_h" value='0'/></td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_craft2ml" value='0'/></td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_craft2ug" value='0'/></td>
                                <td style="width:35px"><input style=width:35px;color:#0000ff;text-align:center;  type="text" name="attr_tot-craft2" value='[[(((@{craft2sb}+@{craft2ss})*@{craft2ml})+@{craft2ug})-(@{P2})]]' disabled="true"/></td>
                                <td style="width:35px"><button type='roll' name='roll_skill' value='!HHEML,@{tot-craft2}+?{EML|0},[[1d100]],skill,@{craft2},Communication Skills'></button></td>
                            </tr>
                        </table>

                        </fieldset>
                        </div>

                   </tr>
                </table>
                </div>
             
                <div class="sheet-break"></div>
                 <div class="sheet-header">Languages/Scripts</div>

                     <div class="sheet-skills">
                   <table border="1" style="width:100%">
                     <tr><td>
                            <table style="width=800px">
                            <tr>
                                <td align=center>skill name</td><td align=center>SB</td><td align=center>SS</td><td align=center>ML</td><td align=center>XP</td><td align=center>EML</td><td></td><td align=center>skill name</td><td align=center>SB</td><td align=center>SS</td><td align=center>ML</td><td align=center>XP</td><td align=center>EML</td><td></td>
                            </tr>
                            <tr>
                                <td style="width:220px;text-align:right;font-weight:bold"><input style=width:170px;text-align:right;font-weight:bold type="text" name="attr_langa"/>&nbsp;</td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_langasb" value='0'/></td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_langass" value='[[@{langass_h}]]' disabled/><input type="hidden" name="attr_langass_h" value='0'/></td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_langaml" value='0'/></td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_langaug" value='0' /></td>
                                <td style="width:35px"><input style=width:35px;color:#0000ff;text-align:center;  type="text" name="attr_tot-langa" value='[[((@{langasb}*@{langaml})+@{langaug})-(@{P2})+?{EML|0}]]' disabled="true"/></td>
                                <td style="width:35px"><button type='roll' name='roll_skill' value='!HHEML,@{tot-langa},[[1d100]],skill,@{langa},Language Skills'></button></td>
                            
                                <td style="width:220px;text-align:right;font-weight:bold"><input style=width:170px;text-align:right;font-weight:bold type="text" name="attr_langb"/>&nbsp;</td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_langbsb" value='0'/></td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_langbss" value='[[@{langbss_h}]]' disabled/><input type="hidden" name="attr_langbss_h" value='0'/></td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_langbml" value='0'/></td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_langbug" value='0'/></td>
                                <td style="width:35px"><input style=width:35px;color:#0000ff;text-align:center;  type="text" name="attr_tot-langb" value='[[((@{langbsb}*@{langbml})+@{langbug})-(@{P2})+?{EML|0}]]' disabled="true"/></td>
                                <td style="width:35px"><button type='roll' name='roll_skill' value='!HHEML,@{tot-langb},[[1d100]],skill,@{langb},Language Skills'></button></td>
                            </tr>
                            </table>
                            <div class="sheet-repitem">
                             <fieldset class="repeating_lang">
                        <table style="width=800px">
                            <tr>
                                <td style="width:220px;text-align:right"><input style=width:170px;text-align:right;font-weight:bold type="text" name="attr_lang1"/>&nbsp;</td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_lang1sb" value='0'/></td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_lang1ss" value='[[@{lang1ss_h}]]' disabled/><input type="hidden" name="attr_lang1ss_h" value='0'/></td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_lang1ml" value='0'/></td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_lang1ug" value='0'/></td>
                                <td style="width:35px"><input style=width:35px;color:#0000ff;text-align:center;  type="text" name="attr_tot-lang1" value='[[((@{lang1sb}*@{lang1ml})+@{lang1ug})-(@{P2})+?{EML|0}]]' disabled="true"/></td>
                                <td style="width:35px"><button type='roll' name='roll_skill' value='!HHEML,@{tot-lang1},[[1d100]],skill,@{lang1},Language Skills'></button></td>
                            
                                <td style="width:220px;text-align:right"><input style=width:170px;text-align:right;font-weight:bold type="text" name="attr_lang2"/>&nbsp;</td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_lang2sb" value='0'/></td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_lang2ss" value='[[@{lang2ss_h}]]' disabled/><input type="hidden" name="attr_lang2ss_h" value='0'/></td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_lang2ml" value='0'/></td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_lang2ug" value='0'/></td>
                                <td style="width:35px"><input style=width:35px;color:#0000ff;text-align:center;  type="text" name="attr_tot-lang2" value='[[((@{lang2sb}*@{lang2ml})+@{lang2ug})-(@{P2})+?{EML|0}]]' disabled="true"/></td>
                                <td style="width:35px"><button type='roll' name='roll_skill' value='!HHEML,@{tot-lang2},[[1d100]],skill,@{lang2},Language Skills'></button></td>
                            </tr>
                        </table>

                        </fieldset>
                        </div>

                   </td></tr>
                </table>
                </div>
        </div><!--end skills section-->

        <div class="sheet-section-combat"><!--beginning of combat section-->

            <div class="sheet-break"></div>
            <div class="sheet-header">Injuries</div>

                 
                 
                         <fieldset class="repeating_injuries">

                        <div class="sheet-injuries">
                            <div class="sheet-repitem">
                       <table border="1" style="width:800px">
                       

                    <tr>

                <td>Description <input style=width:150px type="text" name="attr_inj_desc" /></td>
                <td>Location <select style=width:80px name="attr_inj_loc">
                    <option value=""></option>
                    <option value="Sk">Skull</option>
                    <option value="Fa">Face</option>
                    <option value="EyL">Eye (L)</option>
                    <option value="EyR">Eye (R)</option>
                    <option value="Nk">Neck</option>
                    <option value="ShL">Shoulder (L)</option>
                    <option value="ShR">Shoulder (R)</option>
                    <option value="UaL">Upper Arm (L)</option>
                    <option value="UaR">Upper Arm (R)</option>
                    <option value="ElL">Elbow (L)</option>
                    <option value="ElR">Elbow (R)</option>
                    <option value="FoL">Forearm (L)</option>
                    <option value="FoR">Forearm (R)</option>
                    <option value="HaL">Hand (L)</option>
                    <option value="HaR">Hand (R)</option>
                    <option value="Tx">Thorax</option>
                    <option value="Ab">Abdomen</option>
                    <option value="Hp">Hip</option>
                    <option value="Gr">Groin</option>
                    <option value="ThL">Thigh (L)</option>
                    <option value="ThR">Thigh (R)</option>
                    <option value="KnL">Knee (L)</option>
                    <option value="KnR">Knee (R)</option>
                    <option value="CaL">Calf (L)</option>
                    <option value="CaR">Calf (R)</option>
                    <option value="CaL">Foot (L)</option>
                    <option value="CaR">Foot (R)</option>
                </select></td>
                <td>Type <select style=width:80px name="attr_inj_type"><option value="Blunt">Blunt</option><option value="Edge">Edge</option><option value="Puncture">Puncture</option><option value="Fire/Frost">Fire/Frost</option></select></td>
                <td>Severity<select style=width:80px name="attr_inj_sev"><option value="Minor">Minor</option><option value="Serious">Serious</option><option value="Grevious">Grevious (B)</option></select></td>

                <td>Injury Level <select style=width:60px name="attr_inj_lvl">
                    <option value="0"></option>
                    <option value="1">1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5</option>
                </select></td>
                <td>Treatment <select style=width:60px name="attr_inj_trt">
                    <option value=""></option>
                    <option value="H1">H1</option>
                    <option value="H2">H2</option>
                    <option value="H3">H3</option>
                    <option value="H4">H4</option>
                    <option value="H5">H5</option>
                    <option value="H6">H6</option>
                    <option value="EE">EE</option>
                </select></td>
                <td>Turn Received<input style=width:35px  type="text" name="attr_inj_turn" value="0" /></td>


             </tr>
                   

                 
                </table>
                </div>
                </div></fieldset>
              <br> 
            <div class="sheet-break"></div>
            <input type="hidden" value="0" name="attr_weapons_tot_h">
            <div class="sheet-header">Weapons and Weapon Skills</div>
                              

                            <div class="sheet-repitem">
                         
                        <fieldset class="repeating_Weapons">
            <div class="sheet-weapons">
                      <table border="1" style="width:100%">
                     
                    <tr>                
                            <td>Class<input style=width:70px type="text" name="attr_weapon_class_rep" value='0'/></td>
                            <td>Type<input style=width:70px type="text" name="attr_weapon_name_rep" value='0'/></td>
                            <td>SB<input style=width:35px type="text" name="attr_weapon_Skill_rep" value='0'/><input type="hidden" name="attr_weapon_SS_rep_h" value='0'/></td>
                            <td>ML<input style=width:25px  type="text" name="attr_weapon_ML_rep" value='0'/></td>
                            <td>XP<input style=width:25px  type="text" name="attr_weapon_UG_rep" value='0'/></td>
                            <td>WT<input style=width:25px type="text" name="attr_weapon_WGT_rep" value='0'/><input type="hidden" name="attr_weapon_piece_weight" value='0'/></td>
                            <td>WQ<input style=width:25px  type="text" name="attr_weapon_WQ_rep" value='0'/><button style=width:15px type='roll' name='roll_skill' value='!br,@{character_name},@{weapon_WQ_rep},@{weapon_name_rep},?{modifier|0}'></td>
                            <td>AML<input style=width:25px  type="text" name="attr_weapon_AML_rep" value='0'/></td>
                            <td>DML<input style=width:25px  type="text" name="attr_weapon_DML_rep"value='0' /></td>
                            <td>HM<input style=width:25px type="text" name="attr_weapon_HM_rep" value='0'/></td>
                            <td>B<input style=width:25px type="text" name="attr_weapon_B_rep" value='0'/><button style=width:35px type='roll' name='roll_skill' value='/me rolls [[?{Strike Level|1}d6+@{weapon_B_rep}}]] Damage.'></button></td>


                            <td>E<input style=width:25px  type="text" name="attr_weapon_E_rep" value='0' /><button style=width:35px type='roll' name='roll_skill' value='/me rolls [[?{Strike Level|1}d6+@{weapon_E_rep}]] Damage.'></button></td>


                            <td>P<input style=width:25px  type="text" name="attr_weapon_P_rep" value='0' /><button style=width:35px type='roll' name='roll_skill' value='/me rolls [[?{Strike Level|1}d6+@{weapon_P_rep}]] Damage.'></button></td>

                            <td>F<input style=width:25px  type="text" name="attr_weapon_F_rep" value='0' /><button style=width:35px type='roll' name='roll_skill' value='/me rolls [[?{Strike Level|1}d6+@{weapon_F_rep}]] Damage.'></button></td>

                            <td>AEML<input style=width:35px;font-weight:bold type="text" name="attr_weapon_AEML_rep" value='[[(((@{weapon_Skill_rep}+@{weapon_SS_rep_h})*@{weapon_ML_rep})+@{weapon_UG_rep}+@{weapon_AML_rep})-(@{P4})]]' disabled=true/></td>
                            <td>DEML<input style=width:35px;font-weight:bold  type="text" name="attr_weapon_DEML_rep" value='[[(((@{weapon_Skill_rep}+@{weapon_SS_rep_h})*@{weapon_ML_rep})+@{weapon_UG_rep}+@{weapon_DML_rep})-(@{P4})]]' disabled=true/></td>
                            <td>Att<button style=width:35px type='roll' name='roll_skill' value='!HHEML,[[(((@{weapon_Skill_rep}+@{weapon_SS_rep_h})*@{weapon_ML_rep})+@{weapon_UG_rep}+@{weapon_AML_rep})-(@{P4})+?{bonus|0}]],[[1d100]],weapon,@{weapon_name_rep},@{weapon_class_rep}'></button></td>
                            <td>Def<button style=width:35px type='roll' name='roll_skill' value='!HHEML,[[(((@{weapon_Skill_rep}+@{weapon_SS_rep_h})*@{weapon_ML_rep})+@{weapon_UG_rep}+@{weapon_DML_rep})-(@{P4})+?{bonus|0}]],[[1d100]],weapon,@{weapon_name_rep},@{weapon_class_rep}'></button></td>
                            <td>E<input style=width:15px type="radio" name="attr_weapon_equipped" value='e' title="Equipped/Carried"/><br>N<input style=width:15px type="radio" name="attr_weapon_equipped" value='n' title="Non equipped" checked="true"/></td>


             </tr>
                   

                 
                </table></div></fieldset>
            </div>
            <br>

        <div class="sheet-header">Horses</div>
                              

                            <div class="sheet-repitem">
                         
                        <fieldset class="repeating_horses">
            <div class="sheet-weapons">
                      <table border="1" style="width:100%">             
                    <tr>

                        <td align=center>Name</td><td align=center>Breed</td><td align=center>Ld</td><td align=center>STR</td><td align=center>STA</td><td align=center>AGL</td><td align=center>EYE</td><td align=center>HRG</td><td align=center>SML</td><td align=center>INT</td><td align=center>AUR</td><td align=center>WIL</td><td align=center>INI</td><td align=center>END</td><td align=center>MOV</td><td align=center>DGE</td><td align=center>TRA</td><td align=center>Dam</td><td align=center>Aw</td><td align=center>Riding</td><td></td>
                    </tr>
                    <tr>
                        <td><input type="text" style="width:50px;font-weight:bold;text-align:left" name="attr_horse_name" value="" /></td>
                        <td align=center><select name="attr_breed" style="width:50px">
                            <option value="0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0">choose</option>
                            <option value="320,40,12,11,16,17,20,5,8,12,60,21,36,55,55,10b,72">Reksyni</option>
                            <option value="288,36,11,11,15,20,18,4,8,10,50,19,38,55,55,9b,72">Hacherdad</option>
                            <option value="256,32,10,12,16,18,20,4,7,11,55,18,40,60,60,8b,72">Lankum</option>
                            <option value="240,30,9,13,17,19,19,5,9,12,60,17,45,65,65,8b,72">Khanset</option>
                            <option value="224,28,11,12,16,18,19,4,7,11,55,17,42,60,60,7b,72">Hodiri</option>
                            <option value="216,27,10,13,16,18,18,4,8,10,55,16,40,65,60,7b,68">Chelni</option>
                        </select></td>
                        <td align=center><input type="text" style="width:35px;font-weight:bold;text-align:center" name="attr_horse_load" value="@{horse_load_h}" disabled="true" /><input type="hidden" name="attr_horse_load_h" value="0" /></td>
                        <td align=center><input type="text" style="width:30px;font-weight:bold;text-align:center" name="attr_horse_str" value="@{horse_str_h}" disabled="true" /><input type="hidden" name="attr_horse_str_h" value="0" /></td>
                        <td align=center><input type="text" style="width:30px;font-weight:bold;text-align:center" name="attr_horse_sta" value="@{horse_sta_h}" disabled="true" /><input type="hidden" name="attr_horse_sta_h" value="0" /></td>
                        <td align=center><input type="text" style="width:30px;font-weight:bold;text-align:center" name="attr_horse_agl" value="@{horse_agl_h}" disabled="true" /><input type="hidden" name="attr_horse_agl_h" value="0" /></td>
                        <td align=center><input type="text" style="width:30px;font-weight:bold;text-align:center" name="attr_horse_eye" value="@{horse_eye_h}" disabled="true" /><input type="hidden" name="attr_horse_eye_h" value="0" /></td>
                        <td align=center><input type="text" style="width:30px;font-weight:bold;text-align:center" name="attr_horse_hrg" value="@{horse_hrg_h}" disabled="true" /><input type="hidden" name="attr_horse_hrg_h" value="0" /></td>
                        <td align=center><input type="text" style="width:30px;font-weight:bold;text-align:center" name="attr_horse_sml" value="@{horse_sml_h}" disabled="true" /><input type="hidden" name="attr_horse_sml_h" value="0" /></td>
                        <td align=center><input type="text" style="width:30px;font-weight:bold;text-align:center" name="attr_horse_int" value="@{horse_int_h}" disabled="true" /><input type="hidden" name="attr_horse_int_h" value="0" /></td>
                        <td align=center><input type="text" style="width:30px;font-weight:bold;text-align:center" name="attr_horse_aur" value="@{horse_aur_h}" disabled="true" /><input type="hidden" name="attr_horse_aur_h" value="0" /></td>
                        <td align=center><input type="text" style="width:30px;font-weight:bold;text-align:center" name="attr_horse_wil" value="@{horse_wil_h}" disabled="true" /><input type="hidden" name="attr_horse_wil_h" value="0" /></td>
                        <td align=center><input type="text" style="width:30px;font-weight:bold;text-align:center" name="attr_horse_ini" value="0" /></td>
                        <td align=center><input type="text" style="width:30px;font-weight:bold;text-align:center" name="attr_horse_end" value="@{horse_end_h}" disabled="true" /><input type="hidden" name="attr_horse_end_h" value="0" /></td>
                        <td align=center><input type="text" style="width:30px;font-weight:bold;text-align:center" name="attr_horse_mov" value="@{horse_mov_h}" disabled="true" /><input type="hidden" name="attr_horse_mov_h" value="0" /></td>
                        <td align=center><input type="text" style="width:30px;font-weight:bold;text-align:center" name="attr_horse_dge" value="@{horse_dge_h}" disabled="true" /><input type="hidden" name="attr_horse_dge_h" value="0" /></td>
                        <td align=center><input type="text" style="width:30px;font-weight:bold;text-align:left" name="attr_horse_tra" value="0" /></td>
                        <td align=center><input type="text" style="width:30px;font-weight:bold;text-align:left" name="attr_horse_dam" value="@{horse_dam_h}" disabled="true" /><input type="hidden" name="attr_horse_dam_h" value="0" /></td>
                        <td align=center><input type="text" style="width:30px;font-weight:bold;text-align:left" name="attr_horse_aw" value="@{horse_aw_h}" disabled="true" /><input type="hidden" name="attr_horse_aw_h" value="0" /></td>
                        <td align=center><input type="text" style="width:30px;font-weight:bold;text-align:center;color:#0000ff" name="attr_horse_riding" value="round(((@{riding_tot}-(round((@{Encumbrance}*5)/2))-(@{P1}*5))+@{horse_ini})/2)" disabled="true" /></td>
                        <td style="width:35px"><button type='roll' name='riding_roll' value='!HHEML,@{horse_riding},[[1d100]],skill,Riding,Combat Skills'></button></td>
                    </tr>
                </table>
            </div>
        </fieldset>
        </div>
        <br>
        <div class="sheet-break"></div>
            
            <div class="sheet-header">Armour Total Protection by Location</div>
            <input type="hidden" name="attr_armour_wt_h" value="0">
            <table style=width:800px><tr><td style=width:150px>&nbsp;</td><td>
            <table border="1" style="width:100%">
                <tr><td style="width:80px;font-weight:bold"></td><td style="width:50px;font-weight:bold;text-align:center">B</td><td style="width:50px;font-weight:bold;text-align:center">E</td><td style="width:50px;font-weight:bold;text-align:center">P</td><td style="width:50px;font-weight:bold;text-align:center">F</td></tr>

                <tr><td style="width:80px;font-weight:bold;text-align:right">Skull&nbsp;</td><td style="width:50px;font-weight:bold;text-align:center"><input type="text" style="width:40px;font-weight:bold;text-align:center" name="attr_tot_armour_b0" value="@{armour_b_h_0}" disabled="true"><input type="hidden" name="attr_armour_b_h_0" value="0"></td><td style="width:50px;font-weight:bold;text-align:center"><input type="text" style="width:40px;font-weight:bold;text-align:center" name="attr_tot_armour_e0" value="@{armour_e_h_0}" disabled="true"><input type="hidden" name="attr_armour_e_h_0" value="0"></td><td style="width:50px;font-weight:bold;text-align:center"><input type="text" style="width:40px;font-weight:bold;text-align:center" name="attr_tot_armour_p0" value="@{armour_p_h_0}" disabled="true"><input type="hidden" name="attr_armour_p_h_0" value="0"></td><td style="width:50px;font-weight:bold;text-align:center"><input type="text" style="width:40px;font-weight:bold;text-align:center" name="attr_tot_armour_f0" value="@{armour_f_h_0}" disabled="true"><input type="hidden" name="attr_armour_f_h_0" value="0"></td></tr>

                <tr><td style="width:80px;font-weight:bold;text-align:right">Face&nbsp;</td><td style="width:50px;font-weight:bold;text-align:center"><input type="text" style="width:40px;font-weight:bold;text-align:center" name="attr_tot_armour_b1" value="@{armour_b_h_1}" disabled="true"><input type="hidden" name="attr_armour_b_h_1" value="0"></td><td style="width:50px;font-weight:bold;text-align:center"><input type="text" style="width:40px;font-weight:bold;text-align:center" name="attr_tot_armour_e1" value="@{armour_e_h_1}" disabled="true"><input type="hidden" name="attr_armour_e_h_1" value="0"></td><td style="width:50px;font-weight:bold;text-align:center"><input type="text" style="width:40px;font-weight:bold;text-align:center" name="attr_tot_armour_p1" value="@{armour_p_h_1}" disabled="true"><input type="hidden" name="attr_armour_p_h_1" value="0"></td><td style="width:50px;font-weight:bold;text-align:center"><input type="text" style="width:40px;font-weight:bold;text-align:center" name="attr_tot_armour_f1" value="@{armour_f_h_1}" disabled="true"><input type="hidden" name="attr_armour_f_h_1" value="0"></td></tr>

                <tr><td style="width:80px;font-weight:bold;text-align:right">Neck&nbsp;</td><td style="width:50px;font-weight:bold;text-align:center"><input type="text" style="width:40px;font-weight:bold;text-align:center" name="attr_tot_armour_b2" value="@{armour_b_h_2}" disabled="true"><input type="hidden" name="attr_armour_b_h_2" value="0"></td><td style="width:50px;font-weight:bold;text-align:center"><input type="text" style="width:40px;font-weight:bold;text-align:center" name="attr_tot_armour_e2" value="@{armour_e_h_2}" disabled="true"><input type="hidden" name="attr_armour_e_h_2" value="0"></td><td style="width:50px;font-weight:bold;text-align:center"><input type="text" style="width:40px;font-weight:bold;text-align:center" name="attr_tot_armour_p2" value="@{armour_p_h_2}" disabled="true"><input type="hidden" name="attr_armour_p_h_2" value="0"></td><td style="width:50px;font-weight:bold;text-align:center"><input type="text" style="width:40px;font-weight:bold;text-align:center" name="attr_tot_armour_f2" value="@{armour_f_h_2}" disabled="true"><input type="hidden" name="attr_armour_f_h_2" value="0"></td></tr>

                <tr><td style="width:80px;font-weight:bold;text-align:right">Shoulder&nbsp;</td><td style="width:50px;font-weight:bold;text-align:center"><input type="text" style="width:40px;font-weight:bold;text-align:center" name="attr_tot_armour_b3" value="@{armour_b_h_3}" disabled="true"><input type="hidden" name="attr_armour_b_h_3" value="0"></td><td style="width:50px;font-weight:bold;text-align:center"><input type="text" style="width:40px;font-weight:bold;text-align:center" name="attr_tot_armour_e3" value="@{armour_e_h_3}" disabled="true"><input type="hidden" name="attr_armour_e_h_3" value="0"></td><td style="width:50px;font-weight:bold;text-align:center"><input type="text" style="width:40px;font-weight:bold;text-align:center" name="attr_tot_armour_p3" value="@{armour_p_h_3}" disabled="true"><input type="hidden" name="attr_armour_p_h_3" value="0"></td><td style="width:50px;font-weight:bold;text-align:center"><input type="text" style="width:40px;font-weight:bold;text-align:center" name="attr_tot_armour_f3" value="@{armour_f_h_3}" disabled="true"><input type="hidden" name="attr_armour_f_h_3" value="0"></td></tr>

                <tr><td style="width:80px;font-weight:bold;text-align:right">Upper Arm&nbsp;</td><td style="width:50px;font-weight:bold;text-align:center"><input type="text" style="width:40px;font-weight:bold;text-align:center" name="attr_tot_armour_b4" value="@{armour_b_h_4}" disabled="true"><input type="hidden" name="attr_armour_b_h_4" value="0"></td><td style="width:50px;font-weight:bold;text-align:center"><input type="text" style="width:40px;font-weight:bold;text-align:center" name="attr_tot_armour_e4" value="@{armour_e_h_4}" disabled="true"><input type="hidden" name="attr_armour_e_h_4" value="0"></td><td style="width:50px;font-weight:bold;text-align:center"><input type="text" style="width:40px;font-weight:bold;text-align:center" name="attr_tot_armour_p4" value="@{armour_p_h_4}" disabled="true"><input type="hidden" name="attr_armour_p_h_4" value="0"></td><td style="width:50px;font-weight:bold;text-align:center"><input type="text" style="width:40px;font-weight:bold;text-align:center" name="attr_tot_armour_f4" value="@{armour_f_h_4}" disabled="true"><input type="hidden" name="attr_armour_f_h_4" value="0"></td></tr>

                <tr><td style="width:80px;font-weight:bold;text-align:right">Elbow&nbsp;</td><td style="width:50px;font-weight:bold;text-align:center"><input type="text" style="width:40px;font-weight:bold;text-align:center" name="attr_tot_armour_b5" value="@{armour_b_h_5}" disabled="true"><input type="hidden" name="attr_armour_b_h_5" value="0"></td><td style="width:50px;font-weight:bold;text-align:center"><input type="text" style="width:40px;font-weight:bold;text-align:center" name="attr_tot_armour_e5" value="@{armour_e_h_5}" disabled="true"><input type="hidden" name="attr_armour_e_h_5" value="0"></td><td style="width:50px;font-weight:bold;text-align:center"><input type="text" style="width:40px;font-weight:bold;text-align:center" name="attr_tot_armour_p5" value="@{armour_p_h_5}" disabled="true"><input type="hidden" name="attr_armour_p_h_5" value="0"></td><td style="width:50px;font-weight:bold;text-align:center"><input type="text" style="width:40px;font-weight:bold;text-align:center" name="attr_tot_armour_f5" value="@{armour_f_h_5}" disabled="true"><input type="hidden" name="attr_armour_f_h_5" value="0"></td></tr>

                <tr><td style="width:80px;font-weight:bold;text-align:right">Forearm&nbsp;</td><td style="width:50px;font-weight:bold;text-align:center"><input type="text" style="width:40px;font-weight:bold;text-align:center" name="attr_tot_armour_b6" value="@{armour_b_h_6}" disabled="true"><input type="hidden" name="attr_armour_b_h_6" value="0"></td><td style="width:50px;font-weight:bold;text-align:center"><input type="text" style="width:40px;font-weight:bold;text-align:center" name="attr_tot_armour_e6" value="@{armour_e_h_6}" disabled="true"><input type="hidden" name="attr_armour_e_h_6" value="0"></td><td style="width:50px;font-weight:bold;text-align:center"><input type="text" style="width:40px;font-weight:bold;text-align:center" name="attr_tot_armour_p6" value="@{armour_p_h_6}" disabled="true"><input type="hidden" name="attr_armour_p_h_6" value="0"></td><td style="width:50px;font-weight:bold;text-align:center"><input type="text" style="width:40px;font-weight:bold;text-align:center" name="attr_tot_armour_f6" value="@{armour_f_h_6}" disabled="true"><input type="hidden" name="attr_armour_f_h_6" value="0"></td></tr>

                <tr><td style="width:80px;font-weight:bold;text-align:right">Hand&nbsp;</td><td style="width:50px;font-weight:bold;text-align:center"><input type="text" style="width:40px;font-weight:bold;text-align:center" name="attr_tot_armour_b7" value="@{armour_b_h_7}" disabled="true"><input type="hidden" name="attr_armour_b_h_7" value="0"></td><td style="width:50px;font-weight:bold;text-align:center"><input type="text" style="width:40px;font-weight:bold;text-align:center" name="attr_tot_armour_e7" value="@{armour_e_h_7}" disabled="true"><input type="hidden" name="attr_armour_e_h_7" value="0"></td><td style="width:50px;font-weight:bold;text-align:center"><input type="text" style="width:40px;font-weight:bold;text-align:center" name="attr_tot_armour_p7" value="@{armour_p_h_7}" disabled="true"><input type="hidden" name="attr_armour_p_h_7" value="0"></td><td style="width:50px;font-weight:bold;text-align:center"><input type="text" style="width:40px;font-weight:bold;text-align:center" name="attr_tot_armour_f7" value="@{armour_f_h_7}" disabled="true"><input type="hidden" name="attr_armour_f_h_7" value="0"></td></tr>
                
                 <tr><td style="width:80px;font-weight:bold;text-align:right">Thorax&nbsp;</td><td style="width:50px;font-weight:bold;text-align:center"><input type="text" style="width:40px;font-weight:bold;text-align:center" name="attr_tot_armour_b8" value="@{armour_b_h_8}" disabled="true"><input type="hidden" name="attr_armour_b_h_8" value="0"></td><td style="width:50px;font-weight:bold;text-align:center"><input type="text" style="width:40px;font-weight:bold;text-align:center" name="attr_tot_armour_e8" value="@{armour_e_h_8}" disabled="true"><input type="hidden" name="attr_armour_e_h_8" value="0"></td><td style="width:50px;font-weight:bold;text-align:center"><input type="text" style="width:40px;font-weight:bold;text-align:center" name="attr_tot_armour_p8" value="@{armour_p_h_8}" disabled="true"><input type="hidden" name="attr_armour_p_h_8" value="0"></td><td style="width:50px;font-weight:bold;text-align:center"><input type="text" style="width:40px;font-weight:bold;text-align:center" name="attr_tot_armour_f8" value="@{armour_f_h_8}" disabled="true"><input type="hidden" name="attr_armour_f_h_8" value="0"></td></tr>

                 <tr><td style="width:80px;font-weight:bold;text-align:right">Abdomen&nbsp;</td><td style="width:50px;font-weight:bold;text-align:center"><input type="text" style="width:40px;font-weight:bold;text-align:center" name="attr_tot_armour_b9" value="@{armour_b_h_9}" disabled="true"><input type="hidden" name="attr_armour_b_h_9" value="0"></td><td style="width:50px;font-weight:bold;text-align:center"><input type="text" style="width:40px;font-weight:bold;text-align:center" name="attr_tot_armour_e9" value="@{armour_e_h_9}" disabled="true"><input type="hidden" name="attr_armour_e_h_9" value="0"></td><td style="width:50px;font-weight:bold;text-align:center"><input type="text" style="width:40px;font-weight:bold;text-align:center" name="attr_tot_armour_p9" value="@{armour_p_h_9}" disabled="true"><input type="hidden" name="attr_armour_p_h_9" value="0"></td><td style="width:50px;font-weight:bold;text-align:center"><input type="text" style="width:40px;font-weight:bold;text-align:center" name="attr_tot_armour_f9" value="@{armour_f_h_9}" disabled="true"><input type="hidden" name="attr_armour_f_h_9" value="0"></td></tr>

                 <tr><td style="width:80px;font-weight:bold;text-align:right">Groin&nbsp;</td><td style="width:50px;font-weight:bold;text-align:center"><input type="text" style="width:40px;font-weight:bold;text-align:center" name="attr_tot_armour_b10" value="@{armour_b_h_10}" disabled="true"><input type="hidden" name="attr_armour_b_h_10" value="0"></td><td style="width:50px;font-weight:bold;text-align:center"><input type="text" style="width:40px;font-weight:bold;text-align:center" name="attr_tot_armour_e10" value="@{armour_e_h_10}" disabled="true"><input type="hidden" name="attr_armour_e_h_10" value="0"></td><td style="width:50px;font-weight:bold;text-align:center"><input type="text" style="width:40px;font-weight:bold;text-align:center" name="attr_tot_armour_p10" value="@{armour_p_h_10}" disabled="true"><input type="hidden" name="attr_armour_p_h_10" value="0"></td><td style="width:50px;font-weight:bold;text-align:center"><input type="text" style="width:40px;font-weight:bold;text-align:center" name="attr_tot_armour_f10" value="@{armour_f_h_10}" disabled="true"><input type="hidden" name="attr_armour_f_h_10" value="0"></td></tr>

                 <tr><td style="width:80px;font-weight:bold;text-align:right">Hip&nbsp;</td><td style="width:50px;font-weight:bold;text-align:center"><input type="text" style="width:40px;font-weight:bold;text-align:center" name="attr_tot_armour_b11" value="@{armour_b_h_11}" disabled="true"><input type="hidden" name="attr_armour_b_h_11" value="0"></td><td style="width:50px;font-weight:bold;text-align:center"><input type="text" style="width:40px;font-weight:bold;text-align:center" name="attr_tot_armour_e11" value="@{armour_e_h_11}" disabled="true"><input type="hidden" name="attr_armour_e_h_11" value="0"></td><td style="width:50px;font-weight:bold;text-align:center"><input type="text" style="width:40px;font-weight:bold;text-align:center" name="attr_tot_armour_p11" value="@{armour_p_h_11}" disabled="true"><input type="hidden" name="attr_armour_p_h_11" value="0"></td><td style="width:50px;font-weight:bold;text-align:center"><input type="text" style="width:40px;font-weight:bold;text-align:center" name="attr_tot_armour_f11" value="@{armour_f_h_11}" disabled="true"><input type="hidden" name="attr_armour_f_h_11" value="0"></td></tr>

                 <tr><td style="width:80px;font-weight:bold;text-align:right">Thigh&nbsp;</td><td style="width:50px;font-weight:bold;text-align:center"><input type="text" style="width:40px;font-weight:bold;text-align:center" name="attr_tot_armour_b12" value="@{armour_b_h_12}" disabled="true"><input type="hidden" name="attr_armour_b_h_12" value="0"></td><td style="width:50px;font-weight:bold;text-align:center"><input type="text" style="width:40px;font-weight:bold;text-align:center" name="attr_tot_armour_e12" value="@{armour_e_h_12}" disabled="true"><input type="hidden" name="attr_armour_e_h_12" value="0"></td><td style="width:50px;font-weight:bold;text-align:center"><input type="text" style="width:40px;font-weight:bold;text-align:center" name="attr_tot_armour_p12" value="@{armour_p_h_12}" disabled="true"><input type="hidden" name="attr_armour_p_h_12" value="0"></td><td style="width:50px;font-weight:bold;text-align:center"><input type="text" style="width:40px;font-weight:bold;text-align:center" name="attr_tot_armour_f12" value="@{armour_f_h_12}" disabled="true"><input type="hidden" name="attr_armour_f_h_12" value="0"></td></tr>

                 <tr><td style="width:80px;font-weight:bold;text-align:right">Knee&nbsp;</td><td style="width:50px;font-weight:bold;text-align:center"><input type="text" style="width:40px;font-weight:bold;text-align:center" name="attr_tot_armour_b13" value="@{armour_b_h_13}" disabled="true"><input type="hidden" name="attr_armour_b_h_13" value="0"></td><td style="width:50px;font-weight:bold;text-align:center"><input type="text" style="width:40px;font-weight:bold;text-align:center" name="attr_tot_armour_e13" value="@{armour_e_h_13}" disabled="true"><input type="hidden" name="attr_armour_e_h_13" value="0"></td><td style="width:50px;font-weight:bold;text-align:center"><input type="text" style="width:40px;font-weight:bold;text-align:center" name="attr_tot_armour_p13" value="@{armour_p_h_13}" disabled="true"><input type="hidden" name="attr_armour_p_h_13" value="0"></td><td style="width:50px;font-weight:bold;text-align:center"><input type="text" style="width:40px;font-weight:bold;text-align:center" name="attr_tot_armour_f13" value="@{armour_f_h_13}" disabled="true"><input type="hidden" name="attr_armour_f_h_13" value="0"></td></tr>

                 <tr><td style="width:80px;font-weight:bold;text-align:right">Calf&nbsp;</td><td style="width:50px;font-weight:bold;text-align:center"><input type="text" style="width:40px;font-weight:bold;text-align:center" name="attr_tot_armour_b14" value="@{armour_b_h_14}" disabled="true"><input type="hidden" name="attr_armour_b_h_14" value="0"></td><td style="width:50px;font-weight:bold;text-align:center"><input type="text" style="width:40px;font-weight:bold;text-align:center" name="attr_tot_armour_e14" value="@{armour_e_h_14}" disabled="true"><input type="hidden" name="attr_armour_e_h_14" value="0"></td><td style="width:50px;font-weight:bold;text-align:center"><input type="text" style="width:40px;font-weight:bold;text-align:center" name="attr_tot_armour_p14" value="@{armour_p_h_14}" disabled="true"><input type="hidden" name="attr_armour_p_h_14" value="0"></td><td style="width:50px;font-weight:bold;text-align:center"><input type="text" style="width:40px;font-weight:bold;text-align:center" name="attr_tot_armour_f14" value="@{armour_f_h_14}" disabled="true"><input type="hidden" name="attr_armour_f_h_14" value="0"></td></tr>

                 <tr><td style="width:80px;font-weight:bold;text-align:right">Foot&nbsp;</td><td style="width:50px;font-weight:bold;text-align:center"><input type="text" style="width:40px;font-weight:bold;text-align:center" name="attr_tot_armour_b15" value="@{armour_b_h_15}" disabled="true"><input type="hidden" name="attr_armour_b_h_15" value="0"></td><td style="width:50px;font-weight:bold;text-align:center"><input type="text" style="width:40px;font-weight:bold;text-align:center" name="attr_tot_armour_e15" value="@{armour_e_h_15}" disabled="true"><input type="hidden" name="attr_armour_e_h_15" value="0"></td><td style="width:50px;font-weight:bold;text-align:center"><input type="text" style="width:40px;font-weight:bold;text-align:center" name="attr_tot_armour_p15" value="@{armour_p_h_15}" disabled="true"><input type="hidden" name="attr_armour_p_h_15" value="0"></td><td style="width:50px;font-weight:bold;text-align:center"><input type="text" style="width:40px;font-weight:bold;text-align:center" name="attr_tot_armour_f15" value="@{armour_f_h_15}" disabled="true"><input type="hidden" name="attr_armour_f_h_15" value="0"></td></tr>
             </table>
         </td><td style=width:150px>&nbsp;</td></tr></table>

                <div class="sheet-break"></div>

                     <div class="sheet-header">Clothing & Armour</div>
                <fieldset class="repeating_loc">
                    <div class="sheet-repitem">
                    <table border="1" style="width:100%">
                     
                        <tr>
                            <td align=center style=width:115px;font-weight:bold>
                                <select name="attr_material" style="width:110px;font-weight:bold">
                                    <option value="0,0,0,0,0" selected="selected">select material</option>
                                    <option value="1,1,1,1,1">Cloth/Hair</option>
                                    <option value="5,3,2,4,2">Quilt/Fur</option>
                                    <option value="2,4,3,3,3">Leather/Hide</option>
                                    <option value="4,5,4,3,4">Kurbul</option>
                                    <option value="3,6,4,3,5">Ring</option>
                                    <option value="2,8,5,1,6">Mail</option>
                                    <option value="5,9,4,5,7">Scale</option>
                                    <option value="6,10,6,2,8">Plate</option>
                                </select>
                            </td>
                            <td align=center style=width:290px;font-weight:bold>
                                <select name="attr_piecetype" style="width:285px;font-weight:bold">
                                    <option selected="selected" value="0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0">select piece</option>
                                    <option value="1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1">Cap/Halfhelm (Sk)</option>
                                    <option value="1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,2">Cowl/Hood (Sk Nk)</option>
                                    <option value="1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3">3/4 Helm (Sk Fa)</option>
                                    <option value="1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,4">Great Helm (Sk Fa Nk)</option>
                                    <option value="0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,5">Gorget (Nk)</option>
                                    <option value="0,0,0,1,0,0,0,0,1,1,0,0,0,0,0,0,6">Vest (Sh Tx Ab)</option>
                                    <option value="0,0,0,1,1,0,0,0,1,1,1,1,0,0,0,0,7">Tunic (Ua Sh Tx Ab Hp Gr)</option>
                                    <option value="0,0,0,1,0,0,0,0,1,1,1,1,1,0,0,0,8">Surcoat (Sh Tx Ab Hp Gr Th)</option>
                                    <option value="0,0,0,1,1,1,1,0,1,1,1,1,1,0,0,0,9">Gambeson (Fo El Ua Sh Tx Ab Hp Gr Th)</option>
                                    <option value="0,0,0,1,1,1,1,0,1,1,1,1,1,0,0,0,10">Hauberk (Fo El Ua Sh Tx Ab Hp Gr Th)</option>
                                    <option value="0,0,0,1,1,0,0,0,1,1,1,1,0,0,0,0,11">Byrnie (Ua Sh Tx Ab Hp Gr)</option>
                                    <option value="0,0,0,1,1,1,1,0,1,1,1,1,1,1,1,0,12">Robe (Tunic + Fo El Th Kn Ca)</option>
                                    <option value="0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,13">Kilt (Hp Gr Th)</option>
                                    <option value="0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,14">Leggings (Hp Gr Th Kn Ca Ft)</option>
                                    <option value="0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,15">Shoes (ft)</option>
                                    <option value="0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,16">Boots, calf (Ca Ft)</option>
                                    <option value="0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,17">Boots, knee (Kn Ca Ft)</option>
                                    <option value="0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,18">Gauntlets/Mittens (ha)</option>
                                    <option value="0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,19">Rerebraces (Ua)</option>
                                    <option value="0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,20">Vambraces (Fo)</option>
                                    <option value="0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,21">Kneecops (Kn)</option>
                                    <option value="0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,22">Greaves (Ca)</option>
                                    <option value="0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,23">Coudes (El)</option>
                                    <option value="0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,24">Ailettes (Sh)</option>
                                    <option value="0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,25">Breastplate (Front: Tx Ab)</option>
                                    <option value="0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,26">Backplate (Back: Tx Ab)</option>
                                </select>
                            </td>
                            <td align=center style=width:50px;font-weight:bold>AQ: <input type="text" style="width:30px" title="Armour quality" value="0" name="attr_piece_aq"></td>
                            <td align=center style=width:50px;font-weight:bold>WT: <input type="text" style="width:30px" title="Weight in pounds" value="0" name="attr_piece_wt"><input type="hidden" value="0" name="attr_piece_weight"></td>
                            <td align=center style=width:200px;font-weight:bold>B&nbsp;<input type="text" value="0" name="attr_b" style="font-weight:bold;text-align:center;width:30px">&nbsp;&nbsp;E&nbsp;<input type="text" value="0" name="attr_e" style="font-weight:bold;text-align:center;width:30px">&nbsp;&nbsp;P&nbsp;<input type="text" value="0" name="attr_p" style="font-weight:bold;text-align:center;width:30px">&nbsp;&nbsp;F&nbsp;<input type="text" value="0" name="attr_f" style="font-weight:bold;text-align:center;width:30px">
                            <input type="hidden" name="attr_impact_b_0" value="0"><input type="hidden" name="attr_impact_e_0" value="0"><input type="hidden" name="attr_impact_p_0" value="0"><input type="hidden" name="attr_impact_f_0" value="0">
                            <input type="hidden" name="attr_impact_b_1" value="0"><input type="hidden" name="attr_impact_e_1" value="0"><input type="hidden" name="attr_impact_p_1" value="0"><input type="hidden" name="attr_impact_f_0" value="1">
                            <input type="hidden" name="attr_impact_b_2" value="0"><input type="hidden" name="attr_impact_e_2" value="0"><input type="hidden" name="attr_impact_p_2" value="0"><input type="hidden" name="attr_impact_f_2" value="0">
                            <input type="hidden" name="attr_impact_b_3" value="0"><input type="hidden" name="attr_impact_e_3" value="0"><input type="hidden" name="attr_impact_p_3" value="0"><input type="hidden" name="attr_impact_f_3" value="0">
                            <input type="hidden" name="attr_impact_b_4" value="0"><input type="hidden" name="attr_impact_e_4" value="0"><input type="hidden" name="attr_impact_p_4" value="0"><input type="hidden" name="attr_impact_f_4" value="0">
                            <input type="hidden" name="attr_impact_b_5" value="0"><input type="hidden" name="attr_impact_e_5" value="0"><input type="hidden" name="attr_impact_p_5" value="0"><input type="hidden" name="attr_impact_f_5" value="0">
                            <input type="hidden" name="attr_impact_b_6" value="0"><input type="hidden" name="attr_impact_e_6" value="0"><input type="hidden" name="attr_impact_p_6" value="0"><input type="hidden" name="attr_impact_f_6" value="0">
                            <input type="hidden" name="attr_impact_b_7" value="0"><input type="hidden" name="attr_impact_e_7" value="0"><input type="hidden" name="attr_impact_p_7" value="0"><input type="hidden" name="attr_impact_f_7" value="0">
                            <input type="hidden" name="attr_impact_b_8" value="0"><input type="hidden" name="attr_impact_e_8" value="0"><input type="hidden" name="attr_impact_p_8" value="0"><input type="hidden" name="attr_impact_f_8" value="0">
                            <input type="hidden" name="attr_impact_b_9" value="0"><input type="hidden" name="attr_impact_e_9" value="0"><input type="hidden" name="attr_impact_p_9" value="0"><input type="hidden" name="attr_impact_f_9" value="0">
                            <input type="hidden" name="attr_impact_b_10" value="0"><input type="hidden" name="attr_impact_e_10" value="0"><input type="hidden" name="attr_impact_p_10" value="0"><input type="hidden" name="attr_impact_f_10" value="0">
                            <input type="hidden" name="attr_impact_b_11" value="0"><input type="hidden" name="attr_impact_e_11" value="0"><input type="hidden" name="attr_impact_p_11" value="0"><input type="hidden" name="attr_impact_f_10" value="1">
                            <input type="hidden" name="attr_impact_b_12" value="0"><input type="hidden" name="attr_impact_e_12" value="0"><input type="hidden" name="attr_impact_p_12" value="0"><input type="hidden" name="attr_impact_f_12" value="0">
                            <input type="hidden" name="attr_impact_b_13" value="0"><input type="hidden" name="attr_impact_e_13" value="0"><input type="hidden" name="attr_impact_p_13" value="0"><input type="hidden" name="attr_impact_f_13" value="0">
                            <input type="hidden" name="attr_impact_b_14" value="0"><input type="hidden" name="attr_impact_e_14" value="0"><input type="hidden" name="attr_impact_p_14" value="0"><input type="hidden" name="attr_impact_f_14" value="0">
                            <input type="hidden" name="attr_impact_b_15" value="0"><input type="hidden" name="attr_impact_e_15" value="0"><input type="hidden" name="attr_impact_p_15" value="0"><input type="hidden" name="attr_impact_f_15" value="0">
                            </td>
                            
                            <td>&nbsp;E<input type="radio" value="e" name="attr_ecn" title="Equipped">&nbsp;C<input type="radio" value="c" name="attr_ecn" title="Carried">&nbsp;N<input type="radio" value="n" name="attr_ecn" title="None" checked="true"></td>
                        </tr>
                        <tr><td colspan=6>&nbsp;Description/Notes:&nbsp;<input type="text" value="" name="attr_armour_desc" style=width:600px></td></tr>
                    
                    </table>
                    </div>
                </fieldset>

        </div><!--end combat section-->
         <div class="sheet-section-spells"><!--beginning of spells section-->

            <div class="sheet-break"></div>
                <div class="sheet-header">Shek Pvar</div>
                <div class="sheet-skills">
                   <table border="1" style="width:100%">
                     <tr><td>
                            <table style="width=800px">
                            <tr>
                                <td align=center>skill name</td><td align=center>SB</td><td align=center>ML</td><td align=center>SI</td><td align=center>XP</td><td align=center>Focus</td><td align=center>EML</td><td></td><td align=center>skill name</td><td align=center>SB</td><td align=center>ML</td><td align=center>SI</td><td align=center>XP</td><td align=center>Focus</td><td align=center>EML</td><td></td>
                            </tr>
                            <tr>
                                <td style="width:183px;text-align:right;font-weight:bold">Lyahvi&nbsp;(<input style=width:30px  type="text" name="attr_lyahvi_tot" value='[[(@{shpv1sb}*@{shpv1ml})+@{shpv1ug}]]' disabled="true"/>)&nbsp;</td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_shpv1sb" value='round((@{aura}+@{aura}+@{eyesight}) / 3)' disabled="true"/><input type="hidden" name="attr_lyahviss_h" value="0"></td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_shpv1ml" value='0'/></td>
                                <td style="width:35px"><input style=width:30px  type="text" name="attr_shpv1si" value='[[floor(((@{shpv1sb}*@{shpv1ml})+@{shpv1ug})/10)]]' disabled=true/></td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_shpv1ug" value='0' /></td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_shpv1fo" value='0'/></td>
                                <td style="width:35px"><input style=width:35px;color:#0000ff;text-align:center;  type="text" name="attr_tot-shpv1" value='[[(@{lyahvi_tot}+@{shpv1fo})-(@{P2})]]' disabled="true"/></td>
                                <td style="width:35px"><button type='roll' name='roll_skill' value='/me EML [[@{tot-shpv1}+?{EML|0}]]: rolls [[1d100cs5cs10cs15cs20cs25cs30cs35cs40cs45cs50cs55cs60cs65cs70cs75cs80cs85cs90cs95cs100]] Lyahvi skill.'></button></td>
                            
                                <td style="width:183px;text-align:right;font-weight:bold">Peleahn&nbsp;(<input style=width:30px  type="text" name="attr_peleahn_tot" value='[[(@{shpv2sb}*@{shpv2ml})+@{shpv2ug}]]' disabled="true"/>)&nbsp;</td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_shpv2sb" value='round((@{aura}+@{aura}+@{agility}) / 3)' disabled="true"/><input type="hidden" name="attr_peleahnss_h" value="0"></td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_shpv2ml" value='0'/></td>
                                <td style="width:35px"><input style=width:30px  type="text" name="attr_shpv2si" value='[[floor(((@{shpv2sb}*@{shpv2ml})+@{shpv2ug})/10)]]' disabled=true/></td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_shpv2ug" value='0'/></td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_shpv2fo" value='0'/></td>
                                <td style="width:35px"><input style=width:35px;color:#0000ff;text-align:center;  type="text" name="attr_tot-shpv2" value='[[(@{peleahn_tot}+@{shpv2fo})-(@{P2})]]' disabled="true"/></td>
                                <td style="width:35px"><button type='roll' name='roll_skill' value='/me EML [[@{tot-shpv2}+?{EML|0}]]: rolls [[1d100cs5cs10cs15cs20cs25cs30cs35cs40cs45cs50cs55cs60cs65cs70cs75cs80cs85cs90cs95cs100]] Peleahn skill.'></button></td>
                            </tr>
                             <tr>
                                <td style="width:183px;text-align:right;font-weight:bold">Jmorvi&nbsp;(<input style=width:30px  type="text" name="attr_jmorvi_tot" value='[[((@{shpv3sb}+@{jmorviss_h})*@{shpv3ml})+@{shpv3ug}]]' disabled="true"/>)&nbsp;</td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_shpv3sb" value='round((@{aura}+@{aura}+@{strength}) / 3)' disabled="true"/><input type="hidden" name="attr_jmorviss_h" value="0"></td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_shpv3ml" value='0'/></td>
                                <td style="width:35px"><input style=width:30px  type="text" name="attr_shpv3si" value='[[floor(((@{shpv3sb}*@{shpv3ml})+@{shpv3ug})/10)]]' disabled=true/></td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_shpv3ug" value='0' /></td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_shpv3fo" value='0'/></td>
                                <td style="width:35px"><input style=width:35px;color:#0000ff;text-align:center;  type="text" name="attr_tot-shpv3" value='[[(@{jmorvi_tot}+@{shpv3fo})-(@{P2})]]' disabled="true"/></td>
                                <td style="width:35px"><button type='roll' name='roll_skill' value='/me EML [[@{tot-shpv3}+?{EML|0}]]: rolls [[1d100cs5cs10cs15cs20cs25cs30cs35cs40cs45cs50cs55cs60cs65cs70cs75cs80cs85cs90cs95cs100]] Jmorvi skill.'></button></td>
                            
                                <td style="width:183px;text-align:right;font-weight:bold">Fyvria&nbsp;(<input style=width:30px  type="text" name="attr_fyvria_tot" value='[[(@{shpv4sb}*@{shpv4ml})+@{shpv4ug}]]' disabled="true"/>)&nbsp;</td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_shpv4sb" value='round((@{aura}+@{aura}+@{smell}) / 3)' disabled="true"/><input type="hidden" name="attr_fyvriass_h" value="0"></td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_shpv4ml" value='0'/></td>
                                <td style="width:35px"><input style=width:30px  type="text" name="attr_shpv4si" value='[[floor(((@{shpv4sb}*@{shpv4ml})+@{shpv4ug})/10)]]' disabled=true/></td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_shpv4ug" value='0'/></td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_shpv4fo" value='0'/></td>
                                <td style="width:35px"><input style=width:35px;color:#0000ff;text-align:center;  type="text" name="attr_tot-shpv4" value='[[(@{fyvria_tot}+@{shpv4fo})-(@{P2})]]' disabled="true"/></td>
                                <td style="width:35px"><button type='roll' name='roll_skill' value='/me EML [[@{tot-shpv4}+?{EML|0}]]: rolls [[1d100cs5cs10cs15cs20cs25cs30cs35cs40cs45cs50cs55cs60cs65cs70cs75cs80cs85cs90cs95cs100]] Fyvria skill.'></button></td>
                            </tr>
                            <tr>
                                <td style="width:183px;text-align:right;font-weight:bold">Odivshe&nbsp;(<input style=width:30px  type="text" name="attr_odivshe_tot" value='[[(@{shpv5sb}*@{shpv5ml})+@{shpv5ug}]]' disabled="true"/>)&nbsp;</td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_shpv5sb" value='round((@{aura}+@{aura}+@{dexterity}) / 3)' disabled="true"/><input type="hidden" name="attr_odivshess_h" value="0"></td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_shpv5ml" value='0'/></td>
                                <td style="width:35px"><input style=width:30px  type="text" name="attr_shpv5si" value='[[floor(((@{shpv5sb}*@{shpv5ml})+@{shpv5ug})/10)]]' disabled=true/></td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_shpv5ug" value='0' /></td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_shpv5fo" value='0'/></td>
                                <td style="width:35px"><input style=width:35px;color:#0000ff;text-align:center;  type="text" name="attr_tot-shpv5" value='[[(@{odivshe_tot}+@{shpv5fo})-(@{P2})]]' disabled="true"/></td>
                                <td style="width:35px"><button type='roll' name='roll_skill' value='/me EML [[@{tot-shpv5}+?{EML|0}]]: rolls [[1d100cs5cs10cs15cs20cs25cs30cs35cs40cs45cs50cs55cs60cs65cs70cs75cs80cs85cs90cs95cs100]] Odivshe skill.'></button></td>
                            
                                <td style="width:183px;text-align:right;font-weight:bold">Savorya&nbsp;(<input style=width:30px  type="text" name="attr_savorya_tot" value='[[(@{shpv6sb}*@{shpv6ml})+@{shpv6ug}]]' disabled="true"/>)&nbsp;</td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_shpv6sb" value='round((@{aura}+@{aura}+@{intelligence}) / 3)' disabled="true"/><input type="hidden" name="attr_savoryass_h" value="0"></td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_shpv6ml" value='0'/></td>
                                <td style="width:35px"><input style=width:30px  type="text" name="attr_shpv6si" value='[[floor(((@{shpv6sb}*@{shpv6ml})+@{shpv6ug})/10)]]' disabled=true/></td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_shpv6ug" value='0'/></td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_shpv6fo" value='0'/></td>
                                <td style="width:35px"><input style=width:35px;color:#0000ff;text-align:center;  type="text" name="attr_tot-shpv6" value='[[(@{savorya_tot}+@{shpv6fo})-(@{P2})]]' disabled="true"/></td>
                                <td style="width:35px"><button type='roll' name='roll_skill' value='/me EML [[@{tot-shpv6}+?{EML|0}]]: rolls [[1d100cs5cs10cs15cs20cs25cs30cs35cs40cs45cs50cs55cs60cs65cs70cs75cs80cs85cs90cs95cs100]] Savorya skill.'></button></td>
                            </tr>
                            <tr>
                                <td style="width:183px;text-align:right;font-weight:bold">Neutral&nbsp;(<input style=width:30px  type="text" name="attr_neutral_tot" value='[[(@{shpv7sb}*@{shpv7ml})+@{shpv7ug}]]' disabled="true"/>)&nbsp;</td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_shpv7sb" value='round((@{aura}+@{aura}+@{will}) / 3)' disabled="true"/><input type="hidden" name="attr_neutralss_h" value="0"></td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_shpv7ml" value='0'/></td>
                                <td style="width:35px"><input style=width:30px  type="text" name="attr_shpv7si" value='[[floor(((@{shpv7sb}*@{shpv7ml})+@{shpv7ug})/10)]]' disabled=true/></td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_shpv7ug" value='0' /></td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_shpv7fo" value='0'/></td>
                                <td style="width:35px"><input style=width:35px;color:#0000ff;text-align:center;  type="text" name="attr_tot-shpv7" value='[[(@{neutral_tot}+@{shpv7fo})-(@{P2})]]' disabled="true"/></td>
                                <td style="width:35px"><button type='roll' name='roll_skill' value='/me EML [[@{tot-shpv7}+?{EML|0}]]: rolls [[1d100cs5cs10cs15cs20cs25cs30cs35cs40cs45cs50cs55cs60cs65cs70cs75cs80cs85cs90cs95cs100]] Neutral skill.'></button></td>
                            
                                <td style="width:183px;text-align:right;font-weight:bold">Ritual&nbsp;(<input style=width:30px  type="text" name="attr_rt_tot" value='@{ritual_tot}' disabled="true"/>)&nbsp;</td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_shpv8sb" value='[[@{Ritualsb}]]' disabled="true"/><input type="hidden" name="attr_rtss_h" value="[[@{ritualss}]]"></td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_shpv8ml" value='[[@{Ritualml}]]' disabled="true"/></td>
                                <td style="width:35px"><input style=width:30px  type="text" name="attr_shpv8si" value='[[floor(((@{shpv8sb}*@{shpv8ml})+@{shpv8ug})/10)]]' disabled=true/></td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_shpv8ug" value='0'/></td>
                                <td style="width:35px"><input style=width:35px  type="text" name="attr_shpv8fo" value='0'/></td>
                                <td style="width:35px"><input style=width:35px;color:#0000ff;text-align:center;  type="text" name="attr_tot-shpv8" value='[[(@{rt_tot}+@{shpv8fo})-(@{P2})]]' disabled="true"/></td>
                                <td style="width:35px"><button type='roll' name='roll_skill' value='/me EML [[@{tot-shpv8}+?{EML|0}]]: rolls [[1d100cs5cs10cs15cs20cs25cs30cs35cs40cs45cs50cs55cs60cs65cs70cs75cs80cs85cs90cs95cs100]] Ritual skill.'></button></td>
                            </tr>
                            </table>
                        </td>
                        </tr>
                    </table>
                </div>

                 
                    <div class="sheet-break"></div>
                    
                         <div class="sheet-header">Spells / Rituals</div>
                         Total memorized spell levels: <input type="text" name="attr_tot_mem_spells" value="[[@{tot_mem_spells_1h}+@{tot_mem_spells_2h}+@{tot_mem_spells_3h}+@{tot_mem_spells_4h}+@{tot_mem_spells_5h}+@{tot_mem_spells_6h}+@{tot_mem_spells_7h}+@{tot_mem_spells_8h}]]" style="width:35px;text-align:center" disabled="true"/> (maximum: <input type="text" name="attr_tot_mem_spells_max" value="[[@{aura}+@{will}]]" style="width:35px;text-align:center" disabled="true"/>)
                         <input type="hidden" name="attr_tot_mem_spells_1h" value="0"><input type="hidden" name="attr_tot_mem_spells_2h" value="0"><input type="hidden" name="attr_tot_mem_spells_3h" value="0"><input type="hidden" name="attr_tot_mem_spells_4h" value="0"><input type="hidden" name="attr_tot_mem_spells_5h" value="0"><input type="hidden" name="attr_tot_mem_spells_6h" value="0"><input type="hidden" name="attr_tot_mem_spells_7h" value="0"><input type="hidden" name="attr_tot_mem_spells_8h" value="0"><br>
                
                <div class="sheet-header">Lyahvi</div>
                         
                                 <div class="sheet-repitem">
                <fieldset class="repeating_Lyahvi">
                    <div class="sheet-lyahvi">
                <table border="0" style="width:835px">
                    <tr>
                <td><input style=width:160px;font-weight:bold type="text" name="attr_spriname1as" value='None'/>&nbsp;LVL<input style=width:35px  type="text" name="attr_spri1lvas" value='0'/><select name="attr_liahviACant" style=width:135px><option value=-10>Silence (-10)</option><option value=-5>Whispering (-5)</option><option value=0 selected="selected">Normal voice (+0)</option><option value=5>Shouting (+5)</option></select><select name="attr_liahviAGest" style=width:165px><option value=-10>No movement (-10)</option><option value=-5>Small movement (-5)</option><option value=0 selected="selected">Normal movement (+0)</option><option value=5>Extreme movement (+5)</option></select><select name="attr_liahviANois" style=width:140px><option value=5>Silence (+5)</option><option value=0>Small noises (0)</option><option value=-5 selected="selected">Normal noises (-5)</option><option value=-10>Loud noises (-10)</option><option value=-15>Combat (-15)</option></select>&nbsp;<input type="text" disabled="true" name="attr_lyahvi-roll" value="[[@{tot-shpv1}+@{liahviACant}+@{liahviAGest}+@{liahviANois}-(@{spri1lvas}*5)]]" style="width:35px;font-weight:bold">&nbsp;<button type='roll' name='roll_skill' value='!SEML,[[@{lyahvi-roll}+?{EML|0}]],[[1d100]],lya,@{spriname1as},Lyahvi,@{liahviACant},@{liahviAGest},@{liahviANois}'></button></td>
                <td style="width:70px">Y<input style=width:25px; type="radio" name="attr_lyahvi_mem" value='1'/>N<input style=width:25px; type="radio" name="attr_lyahvi_mem" value='0' checked="true" /><input type="hidden" name="attr_lyahvi_lvl" value="0"></td>
                </tr>
                </table></div></fieldset>
                </div>
                <div class="sheet-break"></div>
                <div class="sheet-header">Peleahn</div>
                    
                            <div class="sheet-repitem">
                <fieldset class="repeating_Peleahn">
                    <div class="sheet-peleahn">
                    <table border="0" style="width:835px">
                    <tr>
                <td><input style=width:160px;font-weight:bold type="text" name="attr_spriname2as" value='None'/>&nbsp;LVL<input style=width:35px  type="text" name="attr_spri2lvas" value='0'/><select name="attr_peleahnACant" style=width:135px><option value=-10>Silence (-10)</option><option value=-5>Whispering (-5)</option><option value=0 selected="selected">Normal voice (+0)</option><option value=5>Shouting (+5)</option></select><select name="attr_peleahnAGest" style=width:165px><option value=-10>No movement (-10)</option><option value=-5>Small movement (-5)</option><option value=0 selected="selected">Normal movement (+0)</option><option value=5>Extreme movement (+5)</option></select><select name="attr_peleahnANois" style=width:140px><option value=5>Silence (+5)</option><option value=0>Small noises (0)</option><option value=-5 selected="selected">Normal noises (-5)</option><option value=-10>Loud noises (-10)</option><option value=-15>Combat (-15)</option></select>&nbsp;<input type="text" disabled="true" name="attr_peleahn-roll" value="[[@{tot-shpv2}+@{peleahnACant}+@{peleahnAGest}+@{peleahnANois}-(@{spri2lvas}*5)]]" style="width:35px;font-weight:bold">&nbsp;<button type='roll' name='roll_skill' value='!SEML,[[@{peleahn-roll}+?{EML|0}]],[[1d100]],pel,@{spriname2as},Peleahn,{peleahnACant},@{peleahnAGest},@{peleahnANois}'></button></td><td style="width:70px">Y<input style=width:25px; type="radio" name="attr_peleahn_mem" value='1'/>N<input style=width:25px; type="radio" name="attr_peleahn_mem" value='0' checked="true" /><input type="hidden" name="attr_peleahn_lvl" value="0"></td>
                </tr></table></div></fieldset>
                </div>

                <div class="sheet-break"></div>
                    <div class="sheet-header">Jmorvi</div>
                                <div class="sheet-repitem">
                                    
                    <fieldset class="repeating_Jmorvi">
                        <div class="sheet-jmorvi">
                        <table border="0" style="width:835px">
                    <tr>
                <td><input style=width:160px;font-weight:bold type="text" name="attr_spriname3as" value='None'/>&nbsp;LVL<input style=width:35px  type="text" name="attr_spri3lvas" value='0'/><select name="attr_jmorviACant" style=width:135px><option value=-10>Silence (-10)</option><option value=-5>Whispering (-5)</option><option value=0 selected="selected">Normal voice (+0)</option><option value=5>Shouting (+5)</option></select><select name="attr_jmorviAGest" style=width:165px><option value=-10>No movement (-10)</option><option value=-5>Small movement (-5)</option><option value=0 selected="selected">Normal movement (+0)</option><option value=5>Extreme movement (+5)</option></select><select name="attr_jmorviANois" style=width:140px><option value=5>Silence (+5)</option><option value=0>Small noises (0)</option><option value=-5 selected="selected">Normal noises (-5)</option><option value=-10>Loud noises (-10)</option><option value=-15>Combat (-15)</option></select>&nbsp;<input type="text" disabled="true" name="attr_jmorvi-roll" value="[[@{tot-shpv3}+@{jmorviACant}+@{jmorviAGest}+@{jmorviANois}-(@{spri3lvas}*5)]]" style="width:35px;font-weight:bold">&nbsp;<button type='roll' name='roll_skill' value='!SEML,[[@{jmorvi-roll}+?{EML|0}]],[[1d100]],jmo,@{spriname3as},Jmorvi,@{jmorviACant},@{jmorviAGest},@{jmorviANois}'></button></td><td style="width:70px">Y<input style=width:25px; type="radio" name="attr_jmorvi_mem" value='1'/>N<input style=width:25px; type="radio" name="attr_jmorvi_mem" value='0' checked="true" /><input type="hidden" name="attr_jmorvi_lvl" value="0"></td>
                
               </tr></table>
               </div></fieldset></div>

                <div class="sheet-break"></div>
                        <div class="sheet-header">Fyvria</div>
                        
                                <div class="sheet-repitem">
                    <fieldset class="repeating_Fyvria">
                        <div class="sheet-fyvria">
                        <table border="0" style="width:835px">
                    <tr>
                <td><input style=width:160px;font-weight:bold type="text" name="attr_spriname4as" value='None'/>&nbsp;LVL<input style=width:35px  type="text" name="attr_spri4lvas" value='0'/><select name="attr_fyvriaACant" style=width:135px><option value=-10>Silence (-10)</option><option value=-5>Whispering (-5)</option><option value=0 selected="selected">Normal voice (+0)</option><option value=5>Shouting (+5)</option></select><select name="attr_fyvriaAGest" style=width:165px><option value=-10>No movement (-10)</option><option value=-5>Small movement (-5)</option><option value=0 selected="selected">Normal movement (+0)</option><option value=5>Extreme movement (+5)</option></select><select name="attr_fyvriaANois" style=width:140px><option value=5>Silence (+5)</option><option value=0>Small noises (0)</option><option value=-5 selected="selected">Normal noises (-5)</option><option value=-10>Loud noises (-10)</option><option value=-15>Combat (-15)</option></select>&nbsp;<input type="text" disabled="true" name="attr_fyvria-roll" value="[[@{tot-shpv4}+@{fyvriaACant}+@{fyvriaAGest}+@{fyvriaANois}-(@{spri4lvas}*5)]]" style="width:35px;font-weight:bold">&nbsp;<button type='roll' name='roll_skill' value='!SEML,[[@{fyvria-roll}+?{EML|0}]],[[1d100]],fyv,@{spriname4as},Fyvria,@{fyvriaACant},@{fyvriaAGest},@{fyvriaANois}'></button></td><td style="width:70px">Y<input style=width:25px; type="radio" name="attr_fyvria_mem" value='1'/>N<input style=width:25px; type="radio" name="attr_fyvria_mem" value='0' checked="true" /><input type="hidden" name="attr_fyvria_lvl" value="0"></td>
                
                </tr></table>
                </div></fieldset></div>

                <div class="sheet-break"></div>            
                <div class="sheet-header">Odivshe</div>
                
                                <div class="sheet-repitem">
                    <fieldset class="repeating_Odivshe">
                        <div class="sheet-odishve">
                        <table border="0" style="width:835px">
                    <tr>
                <td><input style=width:160px;font-weight:bold type="text" name="attr_spriname5as" value='None'/>&nbsp;LVL<input style=width:35px  type="text" name="attr_spri5lvas" value='0'/><select name="attr_odivsheACant" style=width:135px><option value=-10>Silence (-10)</option><option value=-5>Whispering (-5)</option><option value=0 selected="selected">Normal voice (+0)</option><option value=5>Shouting (+5)</option></select><select name="attr_odivsheAGest" style=width:165px><option value=-10>No movement (-10)</option><option value=-5>Small movement (-5)</option><option value=0 selected="selected">Normal movement (+0)</option><option value=5>Extreme movement (+5)</option></select><select name="attr_odivsheANois" style=width:140px><option value=5>Silence (+5)</option><option value=0>Small noises (0)</option><option value=-5 selected="selected">Normal noises (-5)</option><option value=-10>Loud noises (-10)</option><option value=-15>Combat (-15)</option></select>&nbsp;<input type="text" disabled="true" name="attr_odivshe-roll" value="[[@{tot-shpv5}+@{odivsheACant}+@{odivsheAGest}+@{odivsheANois}-(@{spri5lvas}*5)]]" style="width:35px;font-weight:bold">&nbsp;<button type='roll' name='roll_skill' value='!SEML,[[@{odivshe-roll}+?{EML|0}]],[[1d100]],odi,@{spriname5as},Odishve,@{odivsheACant},@{odivsheAGest},@{odivsheANois}'></button></td><td style="width:70px">Y<input style=width:25px; type="radio" name="attr_odishve_mem" value='1'/>N<input style=width:25px; type="radio" name="attr_odishve_mem" value='0' checked="true" /><input type="hidden" name="attr_odivshe_lvl" value="0"></td>
                
                </tr></table>
                </div></fieldset></div>

                <div class="sheet-break"></div>
                    <div class="sheet-header">Savorya</div>
                    
                                <div class="sheet-repitem">
                    <fieldset class="repeating_Savorya">
                        <div class="sheet-savorya">
                        <table border="0" style="width:835px">
                    <tr>
                <td><input style=width:160px;font-weight:bold type="text" name="attr_spriname6as" value='None'/>&nbsp;LVL<input style=width:35px  type="text" name="attr_spri6lvas" value='0'/><select name="attr_savoryaACant" style=width:135px><option value=-10>Silence (-10)</option><option value=-5>Whispering (-5)</option><option value=0 selected="selected">Normal voice (+0)</option><option value=5>Shouting (+5)</option></select><select name="attr_savoryaAGest" style=width:165px><option value=-10>No movement (-10)</option><option value=-5>Small movement (-5)</option><option value=0 selected="selected">Normal movement (+0)</option><option value=5>Extreme movement (+5)</option></select><select name="attr_savoryaANois" style=width:140px><option value=5>Silence (+5)</option><option value=0>Small noises (0)</option><option value=-5 selected="selected">Normal noises (-5)</option><option value=-10>Loud noises (-10)</option><option value=-15>Combat (-15)</option></select>&nbsp;<input type="text" disabled="true" name="attr_savorya-roll" value="[[@{tot-shpv6}+@{savoryaACant}+@{savoryaAGest}+@{savoryaANois}-(@{spri6lvas}*5)]]" style="width:35px;font-weight:bold">&nbsp;<button type='roll' name='roll_skill' value='!SEML,[[@{savorya-roll}+?{EML|0}]],[[1d100]],sav,@{spriname6as},Savorya,@{savoryaACant},@{savoryaAGest},@{savoryaANois}'></button></td><td style="width:70px">Y<input style=width:25px; type="radio" name="attr_savorya_mem" value='1'/>N<input style=width:25px; type="radio" name="attr_savorya_mem" value='0' checked="true" /><input type="hidden" name="attr_savorya_lvl" value="0"></td>
                
                </tr></table>
                </div></fieldset></div>

                <div class="sheet-break"></div>
                        <div class="sheet-header">Neutral</div>
                        
                                <div class="sheet-repitem">
                    <fieldset class="repeating_neutral">
                        <div class="sheet-neutral">
                        <table border="0" style="width:835px">
                    <tr>
                <td><input style=width:160px;font-weight:bold type="text" name="attr_spriname7as" value='None'/>&nbsp;LVL<input style=width:35px  type="text" name="attr_spri7lvas" value='0'/><select name="attr_neutral1Cant" style=width:135px><option value=-10>Silence (-10)</option><option value=-5>Whispering (-5)</option><option value=0 selected="selected">Normal voice (+0)</option><option value=5>Shouting (+5)</option></select><select name="attr_neutral1Gest" style=width:165px><option value=-10>No movement (-10)</option><option value=-5>Small movement (-5)</option><option value=0 selected="selected">Normal movement (+0)</option><option value=5>Extreme movement (+5)</option></select><select name="attr_neutral1Nois" style=width:140px><option value=5>Silence (+5)</option><option value=0>Small noises (0)</option><option value=-5 selected="selected">Normal noises (-5)</option><option value=-10>Loud noises (-10)</option><option value=-15>Combat (-15)</option></select>&nbsp;<input type="text" disabled="true" name="attr_neutral-roll" value="[[@{tot-shpv7}+@{neutral1Cant}+@{neutral1Gest}+@{neutral1Nois}-(@{spri7lvas}*5)]]" style="width:35px;font-weight:bold">&nbsp;<button type='roll' name='roll_skill' value='!SEML,[[@{neutral-roll}+?{EML|0}]],[[1d100]],neu,@{spriname7as},Neutral,@{neutral1Cant},@{neutral1Gest},@{neutral1Nois}'></button></td><td style="width:70px">Y<input style=width:25px; type="radio" name="attr_neutral_mem" value='1'/>N<input style=width:25px; type="radio" name="attr_neutral_mem" value='0' checked="true" /><input type="hidden" name="attr_neutral_lvl" value="0"></td>
                
               </tr></table>
               </div></fieldset></div>

               <br>
                <div class="sheet-break"></div>
                            <div class="sheet-header">Rituals</div>
                            
                            <div class="sheet-repitem">
                    <fieldset class="repeating_Clerical">
                        <div class="sheet-ritual">
                            <table border="0" style="width:835px">
                    <tr>
                <td><input style=width:160px;font-weight:bold type="text" name="attr_spriname8as" value='None'/>&nbsp;LVL<input style=width:35px  type="text" name="attr_spri8lvas" value='0'/><select name="attr_ritual1Cant" style=width:135px><option value=-10>Silence (-10)</option><option value=-5>Whispering (-5)</option><option value=0 selected="selected">Normal voice (+0)</option><option value=5>Shouting (+5)</option></select><select name="attr_ritual1Gest" style=width:165px><option value=-10>No movement (-10)</option><option value=-5>Small movement (-5)</option><option value=0 selected="selected">Normal movement (+0)</option><option value=5>Extreme movement (+5)</option></select><select name="attr_ritual1Nois" style=width:140px><option value=5>Silence (+5)</option><option value=0>Small noises (0)</option><option value=-5 selected="selected">Normal noises (-5)</option><option value=-10>Loud noises (-10)</option><option value=-15>Combat (-15)</option></select>&nbsp;<input type="text" disabled="true" name="attr_ritual-roll" value="[[@{tot-shpv8}+@{ritual1Cant}+@{ritual1Gest}+@{ritual1Nois}-(@{spri8lvas}*5)]]" style="width:35px;font-weight:bold">&nbsp;<button type='roll' name='roll_skill' value='!SEML,[[@{ritual-roll}+?{EML|0}]],[[1d100]],rit,@{spriname8as},Ritual,@{ritual1Cant},@{ritual1Gest},@{ritual1Nois},@{spri8lvas}'></button></td><td style="width:70px;font-size:small">Y<input style=width:20px; type="radio" name="attr_ritual_mem" value='1'/>N<input style=width:20px; type="radio" name="attr_ritual_mem" value='0' checked="true" /><input type="hidden" name="attr_ritual_lvl" value="0"></td>
                
               </tr></table>
               </div></fieldset></div>
            
            
        </div><!--end spells section-->            
                        
            <script type="text/worker">

        /* ---- BEGIN: TheAaronSheet.js ---- */
        // Github:   https://github.com/shdwjk/TheAaronSheet/blob/master/TheAaronSheet.js
        // By:       The Aaron, Arcane Scriptomancer
        // Contact:  https://app.roll20.net/users/104025/the-aaron

        var TAS = TAS || (function(){
            'use strict';

            var version = '0.2.5',
                lastUpdate = 1504710542,

                loggingSettings = {
                    debug: {
                        key:     'debug',
                        title:   'DEBUG',
                        color: {
                            bgLabel: '#7732A2',
                            label:   '#F2EF40',
                            bgText:  '#FFFEB7',
                            text:    '#7732A2'
                        }
                    },
                    error: {
                        key:     'error',
                        title:   'Error',
                        color: {
                            bgLabel: '#C11713',
                            label:   'white',
                            bgText:  '#C11713',
                            text:    'white'
                        }
                    },
                    warn: {
                        key:     'warn',
                        title:   'Warning',
                        color: {
                            bgLabel: '#F29140',
                            label:   'white',
                            bgText:  '#FFD8B7',
                            text:    'black'
                        }
                    },
                    info: {
                        key:     'info',
                        title:   'Info',
                        color: {
                            bgLabel: '#413FA9',
                            label:   'white',
                            bgText:  '#B3B2EB',
                            text:    'black'
                        }
                    },
                    notice: {
                        key:     'notice',
                        title:   'Notice',
                        color: {
                            bgLabel: '#33C133',
                            label:   'white',
                            bgText:  '#ADF1AD',
                            text:    'black'
                        }
                    },
                    log: {
                        key:     'log',
                        title:   'Log',
                        color: {
                            bgLabel: '#f2f240',
                            label:   'black',
                            bgText:  '#ffff90',
                            text:    'black'
                        }
                    },
                    callstack: {
                        key:     'TAS',
                        title:   'function',
                        color: {
                            bgLabel: '#413FA9',
                            label:   'white',
                            bgText:  '#B3B2EB',
                            text:    'black'
                        }
                    },
                    callstack_async: {
                        key:     'TAS',
                        title:   'ASYNC CALL',
                        color: {
                            bgLabel: '#413FA9',
                            label:   'white',
                            bgText:  '#413FA9',
                            text:    'white'
                        }
                    },
                    TAS: {
                        key:     'TAS',
                        title:   'TAS',
                        color: {
                            bgLabel: 'grey',
                            label:   'black;background:linear-gradient(#304352,#d7d2cc,#d7d2cc,#d7d2cc,#304352)',
                            bgText:  'grey',
                            text:    'black;background:linear-gradient(#304352,#d7d2cc,#d7d2cc,#d7d2cc,#304352)'
                        }
                    }
                },


                config = {
                    debugMode: false,
                    logging: {
                        log: true,
                        notice: true,
                        info: true,
                        warn: true,
                        error: true,
                        debug: false
                    }
                },

                callstackRegistry = [],
                queuedUpdates = {}, //< Used for delaying saves till the last moment.

            complexType = function(o){
                switch(typeof o){
                    case 'string':
                        return 'string';
                    case 'boolean':
                        return 'boolean';
                    case 'number':
                        return (_.isNaN(o) ? 'NaN' : (o.toString().match(/\./) ? 'decimal' : 'integer'));
                    case 'function':
                        return 'function: '+(o.name ? o.name+'()' : '(anonymous)');
                    case 'object':
                        return (_.isArray(o) ? 'array' : (_.isArguments(o) ? 'arguments' : ( _.isNull(o) ? 'null' : 'object')));
                    default:
                        return typeof o;
                }
            },

            dataLogger = function(primaryLogger,secondaryLogger,data){
                _.each(data,function(m){
                    var type = complexType(m);
                    switch(type){
                        case 'string':
                            primaryLogger(m);
                            break;
                        case 'undefined':
                        case 'null':
                        case 'NaN':
                            primaryLogger('['+type+']');
                            break;
                        case 'number':
                        case 'not a number':
                        case 'integer':
                        case 'decimal':
                        case 'boolean':
                            primaryLogger('['+type+']: '+m);
                            break;
                        default:
                            primaryLogger('['+type+']:=========================================');
                            secondaryLogger(m);
                            primaryLogger('=========================================================');
                            break;
                    }
                });
            },


            colorLog = function(options){
                var coloredLoggerFunction,
                    key = options.key,
                    label = options.title || 'TAS',
                    lBGColor = (options.color && options.color.bgLabel) || 'blue',
                    lTxtColor = (options.color && options.color.label) || 'white',
                    mBGColor = (options.color && options.color.bgText) || 'blue',
                    mTxtColor = (options.color && options.color.text) || 'white';

                coloredLoggerFunction = function(message){
                    /* eslint-disable no-console */
                    console.log(
                        '%c '+label+': %c '+message + ' ',
                        'background-color: '+lBGColor+';color: '+lTxtColor+'; font-weight:bold;',
                        'background-color: '+mBGColor+';color: '+mTxtColor+';'
                    ); 
                    /* eslint-enable no-console */
                };
                return function(){
                    if('TAS'===key || config.logging[key]){
                        /* eslint-disable no-console */
                       dataLogger(coloredLoggerFunction,function(m){console.log(m);},_.toArray(arguments)); 
                        /* eslint-enable no-console */
                    }
                };
            },

            logDebug  = colorLog(loggingSettings.debug),
            logError  = colorLog(loggingSettings.error),
            logWarn   = colorLog(loggingSettings.warn),
            logInfo   = colorLog(loggingSettings.info),
            logNotice = colorLog(loggingSettings.notice),
            logLog    = colorLog(loggingSettings.log),
            log       = colorLog(loggingSettings.TAS),
            logCS     = colorLog(loggingSettings.callstack),
            logCSA    = colorLog(loggingSettings.callstack_async),

            registerCallstack = function(callstack,label){
                var idx=_.findIndex(callstackRegistry,function(o){
                    return (_.difference(o.stack,callstack).length === _.difference(callstack,o.stack).length) &&
                        _.difference(o.stack,callstack).length === 0 &&
                        o.label === label;
                });
                if(-1 === idx){
                    idx=callstackRegistry.length;
                    callstackRegistry.push({
                        stack: callstack,
                        label: label
                    });
                }
                return idx;
            },

            setConfigOption = function(options){
                var newconf =_.defaults(options,config);
                newconf.logging=_.defaults(
                    (options && options.logging)||{},
                    config.logging
                );
                config=newconf;
            },
            
            isDebugMode = function(){
                return config.debugMode;
            },

            debugMode = function(){
                config.logging.debug=true;
                config.debugMode = true;
            },

            getCallstack = function(){
                var e = new Error('dummy'),
                    stack = _.map(_.rest(e.stack.replace(/^[^(]+?[\n$]/gm, '')
                    .replace(/^\s+at\s+/gm, '')
                    .replace(/^Object.<anonymous>\s*\(/gm, '{anonymous}()@')
                    .split('\n')),function(l){
                        return l.replace(/\s+.*$/,'');
                    });
                return stack;
            },
            logCallstackSub = function(cs){
                var matches, csa;
                _.find(cs,function(line){
                    matches = line.match(/TAS_CALLSTACK_(\d+)/);
                    if(matches){
                       csa=callstackRegistry[matches[1]];
                       logCSA( '===================='+(csa.label ? '> '+csa.label+' <' : '')+'====================');
                       logCallstackSub(csa.stack);
                       return true;
                    } 
                    logCS(line);
                    return false;
                });
            },
            logCallstack = function(){
                var cs;
                if(config.debugMode){
                    cs = getCallstack();
                    cs.shift();
                    log('==============================> CALLSTACK <==============================');
                    logCallstackSub(cs);
                    log('=========================================================================');
                }
            },


            wrapCallback = function (label, callback, context){
                var callstack;
                if('function' === typeof label){
                    context=callback;
                    callback=label;
                    label=undefined;
                }
                if(!config.debugMode){
                    return (function(cb,ctx){
                        return function(){
                            cb.apply(ctx||{},arguments);
                        };
                    }(callback,context));
                }
                
                callstack = getCallstack();
                callstack.shift();
                
                return (function(cb,ctx,cs,lbl){
                    var ctxref=registerCallstack(cs,lbl);

                    /*jshint -W054 */
                    return new Function('cb','ctx','TASlog',
                        "return function TAS_CALLSTACK_"+ctxref+"(){"+
                            "var start,end;"+
                            "TASlog('Entering: '+(cb.name||'(anonymous function)'));"+
                            "start=_.now();"+
                            "cb.apply(ctx||{},arguments);"+
                            "end=_.now();"+
                            "TASlog('Exiting: '+(cb.name||'(anonymous function)')+' :: '+(end-start)+'ms elapsed');"+
                        "};")(cb,ctx,log);
                    /*jshint +W054 */
                }(callback,context,callstack,label));
            },


            prepareUpdate = function( attribute, value ){
                queuedUpdates[attribute]=value;
            },

            applyQueuedUpdates = function() {
              setAttrs(queuedUpdates);
              queuedUpdates = {};
            },

            namesFromArgs = function(args,base){
                return _.chain(args)
                    .reduce(function(memo,attr){
                        if('string' === typeof attr) {
                            memo.push(attr);
                        } else if(_.isArray(args) || _.isArguments(args)){
                            memo = namesFromArgs(attr,memo);
                        }
                        return memo;
                    },(_.isArray(base) && base) || [])
                    .uniq()
                    .value();
            },

            addId = function(obj,value){
                Object.defineProperty(obj,'id',{
                    value: value,
                    writable: false,
                    enumerable: false
                });
            },

            addProp = function(obj,prop,value,fullname){
                (function(){
                    var pname=(_.contains(['S','F','I','D'],prop) ? '_'+prop : prop),
                        full_pname = fullname || prop,
                        pvalue=value;

                    _.each(['S','I','F'],function(p){
                        if( !_.has(obj,p)){
                            Object.defineProperty(obj, p, {
                                value: {},
                                enumerable: false,
                                readonly: true
                            });
                        }
                    });
                    if( !_.has(obj,'D')){
                        Object.defineProperty(obj, 'D', {
                            value: _.reduce(_.range(10),function(m,d){
                                    Object.defineProperty(m, d, {
                                        value: {},
                                        enumerable: true,
                                        readonly: true
                                    });
                                    return m;
                                },{}),
                            enumerable: false,
                            readonly: true
                        });
                    }


                    // Raw value
                    Object.defineProperty(obj, pname, {
                        enumerable: true,
                        set: function(v){
                            if(v!==pvalue) {
                                pvalue=v;
                                prepareUpdate(full_pname,v);
                            }
                        },
                        get: function(){
                            return pvalue;
                        }
                    });
                    
                    // string value
                    Object.defineProperty(obj.S, pname, {
                        enumerable: true,
                        set: function(v){
                            var val=v.toString();
                            if(val !== pvalue) {
                                pvalue=val;
                                prepareUpdate(full_pname,val);
                            }
                        },
                        get: function(){
                            return pvalue.toString();
                        }
                    });

                    // int value
                    Object.defineProperty(obj.I, pname, {
                        enumerable: true,
                        set: function(v){
                            var val=parseInt(v,10) || 0;
                            if(val !== pvalue){
                                pvalue=val;
                                prepareUpdate(full_pname,val);
                            }
                        },
                        get: function(){
                            return parseInt(pvalue,10) || 0;
                        }
                    });

                    // float value
                    Object.defineProperty(obj.F, pname, {
                        enumerable: true,
                        set: function(v){
                            var val=parseFloat(v) || 0;
                            if(val !== pvalue) {
                                pvalue=val;
                                prepareUpdate(full_pname,val);
                            }
                        },
                        get: function(){
                            return parseFloat(pvalue) || 0;
                        }
                    });
                    _.each(_.range(10),function(d){
                        Object.defineProperty(obj.D[d], pname, {
                            enumerable: true,
                            set: function(v){
                                var val=(parseFloat(v) || 0).toFixed(d);
                                if(val !== pvalue){
                                    pvalue=val;
                                    prepareUpdate(full_pname,val);
                                }
                            },
                            get: function(){
                                return (parseFloat(pvalue) || 0).toFixed(d);
                            }
                        });
                    });

                }());
            },
            
            repeating = function( section ) {
                return (function(s){
                    var sectionName = s,
                        attrNames = [],
                        fieldNames = [],
                        operations = [],
                        after = [],
                    
                    repAttrs = function TAS_Repeating_Attrs(){
                        attrNames = namesFromArgs(arguments,attrNames);
                        return this;
                    },
                    repFields = function TAS_Repeating_Fields(){
                        fieldNames = namesFromArgs(arguments,fieldNames);
                        return this;
                    },
                    repReduce = function TAS_Repeating_Reduce(func, initial, final, context) { 
                        operations.push({
                            type: 'reduce',
                            func: (func && _.isFunction(func) && func) || _.noop,
                            memo: (_.isUndefined(initial) && 0) || initial,
                            final: (final && _.isFunction(final) && final) || _.noop,
                            context: context || {}
                        });
                        return this;
                    },
                    repMap = function TAS_Repeating_Map(func, final, context) {
                        operations.push({
                            type: 'map',
                            func: (func && _.isFunction(func) && func) || _.noop,
                            final: (final && _.isFunction(final) && final) || _.noop,
                            context: context || {}
                        });
                        return this;
                    },
                    repEach = function TAS_Repeating_Each(func, final, context) {
                        operations.push({
                            type: 'each',
                            func: (func && _.isFunction(func) && func) || _.noop,
                            final: (final && _.isFunction(final) && final) || _.noop,
                            context: context || {}
                        });
                        return this;
                    },
                    repTap = function TAS_Repeating_Tap(final, context) {
                        operations.push({
                            type: 'tap',
                            final: (final && _.isFunction(final) && final) || _.noop,
                            context: context || {}
                        });
                        return this;
                    },
                    repAfter = function TAS_Repeating_After(callback,context) {
                        after.push({
                            callback: (callback && _.isFunction(callback) && callback) || _.noop,
                            context: context || {}
                        });
                        return this;
                    },
                    repExecute = function TAS_Repeating_Execute(callback,context){
                        var rowSet = {},
                            attrSet = {},
                            fieldIds = [],
                            fullFieldNames = [];

                        repAfter(callback,context);

                        // call each operation per row.
                        // call each operation's final
                        getSectionIDs("repeating_"+sectionName,function(ids){
                            fieldIds = ids;
                            fullFieldNames = _.reduce(fieldIds,function(memo,id){
                                return memo.concat(_.map(fieldNames,function(name){
                                    return 'repeating_'+sectionName+'_'+id+'_'+name;  
                                }));
                            },[]);
                            getAttrs( _.uniq(attrNames.concat(fullFieldNames)), function(values){
                                _.each(attrNames,function(aname){
                                    if(values.hasOwnProperty(aname)){
                                        addProp(attrSet,aname,values[aname]);
                                    }
                                });

                                rowSet = _.reduce(fieldIds,function(memo,id){
                                    var r={};
                                    addId(r,id);
                                    _.each(fieldNames,function(name){
                                        var fn = 'repeating_'+sectionName+'_'+id+'_'+name;  
                                        addProp(r,name,values[fn],fn);
                                    });

                                    memo[id]=r;

                                    return memo;
                                },{});

                                _.each(operations,function(op){
                                    var res;
                                    switch(op.type){
                                        case 'tap':
                                            _.bind(op.final,op.context,rowSet,attrSet)();
                                            break;

                                        case 'each':
                                            _.each(rowSet,function(r){
                                                _.bind(op.func,op.context,r,attrSet,r.id,rowSet)();
                                            });
                                            _.bind(op.final,op.context,rowSet,attrSet)();
                                            break;

                                        case 'map':
                                            res = _.map(rowSet,function(r){
                                                return _.bind(op.func,op.context,r,attrSet,r.id,rowSet)();
                                            });
                                            _.bind(op.final,op.context,res,rowSet,attrSet)();
                                            break;

                                        case 'reduce':
                                            res = op.memo;
                                            _.each(rowSet,function(r){
                                                res = _.bind(op.func,op.context,res,r,attrSet,r.id,rowSet)();
                                            });
                                            _.bind(op.final,op.context,res,rowSet,attrSet)();
                                            break;
                                    }
                                });

                                // finalize attrs
                                applyQueuedUpdates();
                                _.each(after,function(op){
                                    _.bind(op.callback,op.context)();
                                });
                            });
                        });
                    };
                        
                    return {
                        attrs: repAttrs,
                        attr: repAttrs,

                        column: repFields,
                        columns: repFields,
                        field: repFields,
                        fields: repFields,

                        reduce: repReduce,
                        inject: repReduce,
                        foldl: repReduce,

                        map: repMap,
                        collect: repMap,

                        each: repEach,
                        forEach: repEach,

                        tap: repTap,
                        'do': repTap,

                        after: repAfter,
                        last: repAfter,
                        done: repAfter,

                        execute: repExecute,
                        go: repExecute,
                        run: repExecute
                    };
                }(section));
            },


            repeatingSimpleSum = function(section, field, destination){
                repeating(section)
                    .attr(destination)
                    .field(field)
                    .reduce(function(m,r){
                        return m + (r.F[field]);
                    },0,function(t,r,a){
                        a.S[destination]=t;
                    })
                    .execute();
            };

            /* eslint-disable no-console */
            console.log('%c..*`*..*`*.  The Aaron Sheet  v'+version+'  .*`*..*`*..','background: linear-gradient(to right,green,white,white,green); color:black;text-shadow: 0 0 8px white;');
            console.log('%c..*`*..*`*.  Last update: '+(new Date(lastUpdate*1000))+'  .*`*..*`*..','background: linear-gradient(to right,green,white,white,green); color:black;text-shadow: 0 0 8px white;');
            /* eslint-enable no-console */


            return {
                /* Repeating Sections */
                repeatingSimpleSum: repeatingSimpleSum,
                repeating: repeating,

                /* Configuration */
                config: setConfigOption,

                /* Debugging */
                callback: wrapCallback,
                callstack: logCallstack,
                debugMode: debugMode,
                isDebugMode: isDebugMode,
                _fn: wrapCallback,

                /* Logging */
                debug: logDebug,
                error: logError,
                warn: logWarn,
                info: logInfo,
                notice: logNotice,
                log: logLog
            };
        }());

        /* ---- END: TheAaronSheet.js ---- */
            // Order of the stats for the purpose of automatic calculation of skills:
            // 0  str
            // 1  sta
            // 2  dex
            // 3  agi
            // 4  eye
            // 5  hrg
            // 6  sml
            // 7  voi
            // 8  int
            // 9  aur
            // 10 wil
            // 11 cml
            // Order of the signs:
            // 0  Ula
            // 1  Ara
            // 2  Fen
            // 3  Ahn
            // 4  Ang
            // 5  Nad
            // 6  Hir
            // 7  Tar
            // 8  Tai
            // 9  Sko
            // 10 Mas
            // 11 Lad
            var optionalSkills = "acrobatics,dancing,legerdemain,skiing,swimming,acting,lovecraft,mental conflict,musician,language,script,agrik,halea,ilvir,larani,morgath,naveh,peoni,sarajin,save-k'nor,siem,axe,blowgun,bow,club,dagger,flail,net,polearm,shield,sling,spear,sword,whip,agricolture,alchemy,animalcraft,astrology,brewing,ceramics,cookery,drawing,embalming,engineering,fishing,fletching,folklore,foraging,glasswork,heraldry,herblore,hidework,jewelcraft,law,lockcraft,masonry,mathematics,metalcraft,milling,mining,perfumery,physician,piloting,runecraft,seamanship,shipwright,survival,tarotry,textilecraft,timbercraft,tracking,weaponcraft,weatherlore,woodcraft,lyahvi,peleahn,jmorvi,fyvria,odivshe,savorya,neutral,unarmed,riding,mercantyler,adaenum,anoa,bujoc,chelni,chymak,equani,gozyda,hodiri,kabloqui,kamaki,kath,kubora,pagaelin,solori,taelda,tulwyr,urdu,ymodi,oratory,intrigue,rhetoric,charm,clairvoyance,disembodiment,healing,hex,medium,mental bolt,negation,prescience,psychometry,pyrokinesis,sensitivity,telekinesis,telepathy,transference,transmutation,initiative";
            var skillsArray = new Array();
            skillsArray = optionalSkills.split(",");
            var stats = new Array();
            var tempStats = "0,3,3|2,3,3|2,2,10|0,2,3|1,2,3|3,7,8|11,3,7|9,10,10|2,5,5|7,8,10|2,4,8|7,8,0|7,8,11|7,8,9|7,8,10|7,8,9|7,8,10|7,8,2|7,8,0|7,8,8|7,8,9|0,0,2|1,2,4|0,2,4|0,0,2|2,2,4|2,2,2|2,2,4|0,0,2|0,2,2|2,2,4|0,0,2|0,2,2|2,2,4|0,1,10|6,8,9|3,7,10|4,8,9|2,6,6|2,2,4|2,6,6|2,4,4|2,4,6|2,8,8|2,4,10|2,2,4|7,8,8|2,6,8|2,4,10|2,4,10|4,6,8|2,6,10|2,4,10|7,8,10|2,4,10|0,2,8|8,8,10|0,2,10|0,2,6|0,4,8|6,6,8|2,4,8|2,4,8|8,9,9|0,2,3|0,2,8|0,2,8|8,9,10|2,2,4|0,2,3|4,6,10|0,2,10|8,4,6|2,2,10|9,9,4|9,9,3|9,9,0|9,9,6|9,9,2|9,9,8|9,9,10|0,2,3|0,3,10|4,8,8|2,7,8|7,8,9|7,8,9|7,8,9|2,7,8|7,8,9|7,8,10||7,8,9|2,7,8|7,8,9|7,8,9|7,8,9|7,7,8|7,8,9|1,7,8|7,8,9|7,8,9|7,8,11|8,9,10|7,8,10|9,9,10|9,9,10|9,9,10|9,9,10|9,9,10|9,9,10|9,9,10|9,9,10|9,9,10|9,9,10|9,9,10|9,9,10|9,9,10|9,9,10|9,9,10|9,9,10|3,10,10";
            //
            var tempSS = "5:2,6:1|7:2,6:1,8:1|7:2,8:2,9:2|10:2,9:1,11:1|9:1,10:3,11:3|7:1,8:1|10:1,4:1|0:0|10:1,4:1|8:1|7:1,8:1|5:2,3:1,4:1|7:2,6:1,10:1|9:2,8:1,0:1|4:2,2:1,3:1|11:2,3:1,10:1|10:2,7:1,9:1|1:2,0:1,4:1|2:2,1:1,11:1|8:2,7:1,9:1|6:2,0:1,2:1|2:1,3:1,4:1|6:2,5:1,7:1|5:1,6:1,7:1|0:1,1:1|4:2,5:2|5:1,6:1,7:1|9:1,10:1,11:1|1:1,4:1|0:1,10:1,11:1|5:1,6:1,7:1|0:1,1:1,2:1|4:3,3:1,5:1|5:1,6:1|0:2,1:2|9:3,8:2,10:2|0:1,1:1|7:1|9:3,8:2,10:2|0:2,1:2|9:1|8:1,9:1|0:1,9:1|0:2,1:2,2:1|10:2,11:2|6:2,5:1,7:1|8:2|0:2,1:2|2:2|8:1,9:1|0:3,1:2|0:1,1:1|2:3,1:1,7:1|7:1,8:1|2:1|0:2,1:2|8:3,7:1,9:1|2:3,3:1,4:1|0:1|0:2,1:2,2:1|6:1,7:1,9:1|10:2,8:1,9:1|11:3,10:1|8:2,9:1|11:3,9:1,10:1|11:3,10:1|0:2,1:1|7:2,8:2,6:1,9:1|0:1,1:1|0:3,1:1|0:3,1:3|2:3,3:1,4:1|6:1,7:1,10:1,11:1|0:2,1:1,11:1|0:-3,1:-2,2:-1,3:0,4:1,5:2,6:3,7:2,8:1,9:0,10:-1,11:-2|0:-1,1:0,2:1,3:2,4:3,5:2,6:1,7:0,8:-1,9:-2,10:-3,11:-2|0:1,1:2,2:3,3:2,4:1,5:0,6:-1,7:-2,8:-3,9:-2,10:-1,11:0|0:3,1:2,2:1,3:0,4:-1,5:-2,6:-3,7:-2,8:-1,9:0,10:1,11:2|0:1,1:0,2:-1:3:-2,4:-3,5:-2,6:-1,7:0,8:1,9:2,10:3,11:2|0:-1,1:-2,2:-3,3:-2,4:-1,5:0,6:1,7:2,8:3,9:2,10:1,11:0|0:0|0:2,10:2,11:2|0:1,1:1|7:2,8:2,9:1|11:2,6:1,9:1|9:2,8:1,0:1|0:0|3:2,2:1,8:1|11:2,2:1,9:1|1:2,4:1,2:1|3:2,7:1,8:1|0:0|1:2,4:1,2:1|11:2,3:1,0:1|6:2,3:1,0:1|1:2,0:1,7:1|0:0|4:2,5:1,8:1|0:2,6:1,8:1|6:2,4:1,9:1|1:2,10:1,8:1||7:1|7:1,8:1,9:1|7:1,8:1,9:1|5:1,7:1,8:1|8:1|5:1,6:1|9:1,10:1|3:1|8:1|3:1|2:1|7:1,8:1|8:1,10:1|3:1,4:1,5:1|7:1,8:1|3:1,5:1|7:1,8:1,9:1|7:1,8:1|7:1,8:1||";
            var tempOML = "2,2,1,1,1,2,3,3,1,1,1,1,1,1,1,1,1,1,1,1,1,3,4,2,4,3,1,1,2,3,1,3,3,1,2,1,1,1,2,2,3,2,1,1,3,1,3,3,1,1,1,2,1,1,1,1,1,1,2,1,1,1,1,1,2,1,3,1,2,2,2,1,3,2,0,0,0,0,0,0,0,4,1,4,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,2,3,3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4";
            var tempWeapons = "hand,foot,head,buckler,knight,round,kite,tower,knife,dagger,taburi,keltan,longknife,shortsword,mankar,mang,broadsword,estoc,falchion,bastard sword,battlesword,stick,club,mace,morningstar,maul,sickle,shorkana,hatchet,handaxe,warhammer,battleaxe,nachakas,grainflail,ball & chain,warflail,staff,javelin,spear,trident,lance,glaive,jousting pole,poleaxe,pike,net,whip,isagra,crossbow,shortbow,longbow,hartbow,blowgun,sling,staff sling,punch,kick";
            var tempWeaponDamage = "0,0,0|1,0,0|1,0,0|1,0,0|2,0,0|2,0,0|3,0,0|3,0,0|0,1,4|1,2,5|0,0,4|2,0,3|1,3,5|2,4,4|2,5,0|3,6,0|3,5,3|3,0,6|4,6,1|4,7,4|5,8,4|2,0,0|4,0,0|6,0,0|0,0,5|7,0,0|1,4,3|3,5,0|3,4,0|4,6,0|6,0,0|6,9,0|4,0,0|5,0,0|8,0,0|9,0,0|4,0,0|2,0,6|4,0,7|4,0,5|4,0,8|6,7,6|3,0,0|6,9,6|4,0,8|2,0,0|2,1,0|3,3,0|0,0,0|0,0,0|0,0,0|0,0,0|1,0,0|0,0,0|0,0,0|0,0,0|1,0,0";
            var tempWeaponWT = "0,0,0,3,5,6,7,8,1,1,1,2,1,2,2,3,3,3,4,5,8,2,3,4,5,7,1,2,2,3,5,6,1,2,4,5,4,3,5,6,8,8,8,8,12,4,2,4,5,2,3,2,1,0.1,1,0,0";
            var tempWeaponQ = "0,0,0,12,13,13,14,14,10,11,10,12,12,12,11,11,12,11,12,12,13,9,9,11,11,9,9,10,9,11,11,12,10,9,12,11,11,10,11,12,11,11,8,11,12,9,9,11,10,10,11,13,8,9,10,0,0";
            var tempWeaponBonus = "0,15|5,5|0,0|5,15|5,20|5,20|5,25|5,25|5,0|5,5|5,0|5,10|10,15|10,5|10,5|15,10|15,10|15,10|15,5|20,10|25,10|5,5|15,5|15,5|20,5|20,5|5,5|5,5|5,5|10,5|15,5|20,10|15,10|20,5|20,10|25,10|20,15|15,5|20,10|20,15|25,5|25,10|25,5|25,5|25,5|20,0|25,5|25,5|0,0|0,0|0,0|0,0|0,0|0,0|0,0|0,15|5,5";
            var tempWeaponHM = "0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-5,0,0,0,-10,-20,0,0,0,-10,-20,0,0,0,0,-5,-15,0,0,0,-20,-10,-10,-10,-10,-15,-20,-25,-15,-25,0,0,0,0,0,0,0,0,0,-10,0,0";
            var weightMatrix = new Array();
            weightMatrix = [
            [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
            [0,0.4,0.8,0.6,1.2,0.4,2.8,4.4,5.2,6.5,6.5,4.4,7.8,2.8,4.4,1.4,2.2,2.8,0.4,0.6,0.6,0.4,0.4,0.4,0.4,1,1],
            [0,1.2,2.4,1.8,3,1.2,9.6,13.2,13.6,19.5,19.5,13.2,22.6,4.5,9.2,2.4,3.2,4.2,1.4,1.6,1.6,1.2,1.4,1.2,1.4,3.6,3.6],
            [0,0.8,1.6,1.2,2,0.4,5.6,8.8,10.4,12,12,8.8,14.4,3.4,8.8,1.2,3.2,3.8,0.8,0.8,0.8,0.8,1.4,0.6,1.4,2.4,2.4],
            [0,1,1.8,1.4,2.2,0.5,7.2,9.2,10.8,12.8,12.8,9.2,16,2.6,6.6,1.6,4,4.8,1.2,1.2,1.2,1.2,1.6,1,1.6,3,3],
            [0,1.6,2.6,2.4,3.4,1.4,11.2,17.6,18.8,26,26,17.6,34.4,4.8,17.6,2,4.8,6.2,1.6,1.8,1.8,1.8,3.4,1.6,3.4,5,5],
            [0,2.8,4,3.8,5,2.4,9.4,22,26,32.5,32.5,26,38.8,6.4,22,3,8,10.8,2,1.8,2,2.2,4,1.8,5,8,8],
            [0,2,3.4,3.2,4.6,1.4,19.6,30.8,34.4,45.5,45.5,19.6,52.2,8.6,31.8,4.4,10.8,14.4,2.8,2.4,2.8,2,5.8,2.8,7.6,11.6,11.6],
            [0,3.2,6,5.6,8.8,3.2,32.4,50.6,56.8,76,76,32.4,90.8,14.8,52,7.6,17.4,22.8,4.8,4.8,4,2.4,8,1.6,3.2,9.6,9.6]
            ];
            
            var signs = tempSS.split("|");
            stats = tempStats.split("|");
            var weapons = tempWeapons.split(",");
            var wWT = tempWeaponWT.split(",");
            var wWQ = tempWeaponQ.split(",");
            var wDamage = tempWeaponDamage.split("|");
            var wBonus = tempWeaponBonus.split("|");
            var wHM = tempWeaponHM.split(",");
            var numSkills = skillsArray.length;
            var OML = tempOML.split(",");
            var skillSB = 0;
            var isSpell;
            var maxBonus;
            var newML;

            function calcSkill(skillName, fieldName, fieldSS, fieldML, fieldMLval)
            {
                getAttrs(["strength", "stamina", "dexterity", "agility", "eyesight", "hearing", "smell", "voice", "intelligence", "aura", "will", "comeliness", "sunsigntable_h"], function(values) {
                    
                    var stat = new Array();
                    var sign = values.sunsigntable_h.split(",");
                    
                    stat[0] = values.strength;
                    stat[1] = values.stamina;
                    stat[2] = values.dexterity;
                    stat[3] = values.agility;
                    stat[4] = values.eyesight;
                    stat[5] = values.hearing;
                    stat[6] = values.smell;
                    stat[7] = values.voice;
                    stat[8] = values.intelligence;
                    stat[9] = values.aura;
                    stat[10] = values.will;
                    stat[11] = values.comeliness;
                    skillName = skillName.toLowerCase();
                    var i;
                    if (skillName == "")
                    {

                        setAttrs({
                            [fieldName]: "",
                            [fieldSS]: "",
                            [fieldML]: ""
                        });
                  
                    }
                    else{
                        for(i = 0; i < numSkills; i++){
                            if(skillName.indexOf(skillsArray[i]) >= 0)
                                    {
                                        var threeStats = new Array();
                                        threeStats = stats[i].split(",");
                                        var first = parseInt(threeStats[0]);
                                        var second = parseInt(threeStats[1]);
                                        var third = parseInt(threeStats[2]);
                                        skillSB = Math.round((parseInt(stat[first])+parseInt(stat[second])+parseInt(stat[third]))/3);
                                        setAttrs({
                                            [fieldName]: skillSB
                                        });
                                        var signsList = signs[i].split(",");
                                        
                                        var tempArray = new Array();

                                        for(var n = 0; n < signsList.length; n++)
                                        {
                                            var sCouples = new Array();
                                            sCouples = signsList[n].split(":");
                                            var segno = parseInt(sCouples[0]);
                                            tempArray[n] = parseInt(sign[segno])*sCouples[1];
                                        }
                                        tempArray.sort(function(a,b){return a-b});
                                        maxBonus=tempArray.pop();
                                        isSpell=tempArray.shift();
                                        if(isSpell<0)
                                        {
                                            maxBonus = isSpell;
                                        }
                                            setAttrs({
                                                [fieldSS]: maxBonus
                                            });
                                        newML = parseInt(OML[i]);
                                        if(parseInt(fieldMLval)>parseInt(OML[i]))
                                        {
                                           newML = parseInt(fieldMLval);
                                        }
                                        setAttrs({
                                                [fieldML]: newML
                                            }); 
                                    }
                                    

                            }
                    }
                }); 
               
            }

            function calcWStats(skillName){
                numWeapons = weapons.length;
                skillName = skillName.toLowerCase();

                for(var i = 0; i < numWeapons; i++){
                    if(skillName.indexOf(weapons[i]) >= 0)
                    {
                        var ADML = wBonus[i].split(",");
                        var wAspect = wDamage[i].split(",");
                        setAttrs({
                            repeating_Weapons_weapon_WGT_rep: wWT[i],
                            repeating_Weapons_weapon_WQ_rep: wWQ[i],
                            repeating_Weapons_weapon_AML_rep: ADML[0],
                            repeating_Weapons_weapon_DML_rep: ADML[1],
                            repeating_Weapons_weapon_HM_rep: wHM[i],
                            repeating_Weaponsattr_weapon_B_rep: wAspect[0],
                            repeating_Weaponsattr_weapon_E_rep: wAspect[1],
                            repeating_Weaponsattr_weapon_P_rep: wAspect[2]
                        });
                    }
                }
            }
            

            
            // Calculate Armor Weights
            on('change:repeating_loc:material remove:repeating_loc',function(){
                    
                    getAttrs([
                        "repeating_loc_material", "repeating_loc_piecetype", "repeating_loc_ecn", "repeating_loc_b", "repeating_loc_e", "repeating_loc_p", "repeating_loc_f", "bodysize", "repeating_loc_ecn", "repeating_loc_piece_wt"

                        ], function(values) {
                            //console.log("type: " + values.repeating_loc_piecetype);
                            var locs = values.repeating_loc_piecetype.split(",");
                            var mats = values.repeating_loc_material.split(",");
                            var matType = mats[4];
                            var locType = locs[16];
                            var wMultiplier = Number(values.bodysize)-6;
                            

                            var adjWeight = Math.round((weightMatrix[matType][locType]*((100+(wMultiplier*10))/100))*10)/10;
                            
                            setAttrs({
                                        repeating_loc_piece_wt: adjWeight
                                    });
                            
                            setAttrs({
                                        repeating_loc_b: mats[0],
                                        repeating_loc_e: mats[1],
                                        repeating_loc_p: mats[2],
                                        repeating_loc_f: mats[3]
                                    });
                            //console.log("repeating_loc_b: ++++++++++++++: " + values.repeating_loc_b + "++++++++++++++");
                            if(values.repeating_loc_ecn == 'n')
                                {   setAttrs({
                                        repeating_loc_piece_weight: 0
                                    });
                                    TAS.repeatingSimpleSum('loc','piece_weight','armour_wt_h');
                                     for (var n=0; n<(locs.length-1); n++)
                                        {
                                            setAttrs({
                                                ["repeating_loc_impact_b_"+[n]]: 0,
                                                ["repeating_loc_impact_e_"+[n]]: 0,
                                                ["repeating_loc_impact_p_"+[n]]: 0,
                                                ["repeating_loc_impact_f_"+[n]]: 0
                                            });
                                            TAS.repeatingSimpleSum('loc','impact_b_'+[n],'armour_b_h_'+[n]);
                                            TAS.repeatingSimpleSum('loc','impact_e_'+[n],'armour_e_h_'+[n]);
                                            TAS.repeatingSimpleSum('loc','impact_p_'+[n],'armour_p_h_'+[n]);
                                            TAS.repeatingSimpleSum('loc','impact_f_'+[n],'armour_f_h_'+[n]);
                                        }
                                }
                            else if(values.repeating_loc_ecn == 'c' || values.repeating_loc_ecn == 'e')
                            {
                                setAttrs({
                                    repeating_loc_piece_weight: values.repeating_loc_piece_wt
                                });
                                TAS.repeatingSimpleSum('loc','piece_weight','armour_wt_h');
                                
                                
                                    for (var n=0; n<(locs.length-1); n++)
                                    {
                                        if(locs[n] == '1' && values.repeating_loc_ecn == 'e')
                                        {   setAttrs({
                                                ["repeating_loc_impact_b_"+[n]]: mats[0],
                                                ["repeating_loc_impact_e_"+[n]]: mats[1],
                                                ["repeating_loc_impact_p_"+[n]]: mats[2],
                                                ["repeating_loc_impact_f_"+[n]]: mats[3]
                                            });
                                        
                                        }
                                        else
                                        {
                                            setAttrs({
                                                ["repeating_loc_impact_b_"+[n]]: 0,
                                                ["repeating_loc_impact_e_"+[n]]: 0,
                                                ["repeating_loc_impact_p_"+[n]]: 0,
                                                ["repeating_loc_impact_f_"+[n]]: 0
                                            });
                                        }
                                        TAS.repeatingSimpleSum('loc','impact_b_'+[n],'armour_b_h_'+[n]);
                                        TAS.repeatingSimpleSum('loc','impact_e_'+[n],'armour_e_h_'+[n]);
                                        TAS.repeatingSimpleSum('loc','impact_p_'+[n],'armour_p_h_'+[n]);
                                        TAS.repeatingSimpleSum('loc','impact_f_'+[n],'armour_f_h_'+[n]);
                                    }
                                
                            }
                            
                    });
                    
            });

            on('change:repeating_loc:piece_wt',function(){
                    
                    getAttrs([
                        "repeating_loc_ecn",
                        "repeating_loc_piece_wt"
                        ], function(values) {
                            
                            
                            if(values.repeating_loc_ecn == 'n')
                                {   setAttrs({
                                        repeating_loc_piece_weight: 0,
                                    });
                                    TAS.repeatingSimpleSum('loc','piece_weight','armour_wt_h');
                                     
                                }
                            else if(values.repeating_loc_ecn == 'c' || values.repeating_loc_ecn == 'e')
                            {
                                setAttrs({
                                    repeating_loc_piece_weight: values.repeating_loc_piece_wt
                                });
                                TAS.repeatingSimpleSum('loc','piece_weight','armour_wt_h');

                            }
                            
                    });
                    
            });

            on('change:repeating_loc:b change:repeating_loc:e change:repeating_loc:p change:repeating_loc:f change:repeating_loc:ecn',function(){
                    
                    getAttrs([
                        "repeating_loc_piecetype",
                        "repeating_loc_material",
                        "repeating_loc_b",
                        "repeating_loc_e",
                        "repeating_loc_p",
                        "repeating_loc_f",
                        "repeating_loc_ecn",
                        "repeating_loc_piece_wt"
                        ], function(values) {
                            //console.log("type: " + values.repeating_loc_piecetype);
                            var locs = values.repeating_loc_piecetype.split(",");
                            var mats = values.repeating_loc_material.split(",");
                            var matType = mats[4];
                            var locType = locs[16];
                            
                            if(values.repeating_loc_ecn == 'n')
                                {   
                                    setAttrs({
                                        repeating_loc_piece_weight: 0,
                                    });
                                    
                                     for (var n=0; n<(locs.length-1); n++)
                                        {
                                            setAttrs({
                                                ["repeating_loc_impact_b_"+[n]]: 0,
                                                ["repeating_loc_impact_e_"+[n]]: 0,
                                                ["repeating_loc_impact_p_"+[n]]: 0,
                                                ["repeating_loc_impact_f_"+[n]]: 0
                                            });
                                        TAS.repeatingSimpleSum('loc','impact_b_'+[n],'armour_b_h_'+[n]);
                                        TAS.repeatingSimpleSum('loc','impact_e_'+[n],'armour_e_h_'+[n]);
                                        TAS.repeatingSimpleSum('loc','impact_p_'+[n],'armour_p_h_'+[n]);
                                        TAS.repeatingSimpleSum('loc','impact_f_'+[n],'armour_f_h_'+[n]);
                                        }
                                }
                            else if(values.repeating_loc_ecn == 'c' || values.repeating_loc_ecn == 'e')
                            {
                                    setAttrs({
                                        repeating_loc_piece_weight: values.repeating_loc_piece_wt
                                    });
                                    for (var n=0; n<(locs.length-1); n++)
                                    {
                                        if(locs[n] == '1' && values.repeating_loc_ecn == 'e')
                                        {   setAttrs({
                                                ["repeating_loc_impact_b_"+[n]]: values.repeating_loc_b,
                                                ["repeating_loc_impact_e_"+[n]]: values.repeating_loc_e,
                                                ["repeating_loc_impact_p_"+[n]]: values.repeating_loc_p,
                                                ["repeating_loc_impact_f_"+[n]]: values.repeating_loc_f
                                            });
                                        }
                                        else
                                        {
                                            setAttrs({
                                                ["repeating_loc_impact_b_"+[n]]: 0,
                                                ["repeating_loc_impact_e_"+[n]]: 0,
                                                ["repeating_loc_impact_p_"+[n]]: 0,
                                                ["repeating_loc_impact_f_"+[n]]: 0
                                            });
                                        }
                                        TAS.repeatingSimpleSum('loc','impact_b_'+[n],'armour_b_h_'+[n]);
                                        TAS.repeatingSimpleSum('loc','impact_e_'+[n],'armour_e_h_'+[n]);
                                        TAS.repeatingSimpleSum('loc','impact_p_'+[n],'armour_p_h_'+[n]);
                                        TAS.repeatingSimpleSum('loc','impact_f_'+[n],'armour_f_h_'+[n]);
                                    }
                                
                            }
                        TAS.repeatingSimpleSum('loc','piece_weight','armour_wt_h');
                    });
                    
            });

            on('change:repeating_loc:piecetype',function(){
                    
                    getAttrs([
                        "repeating_loc_piecetype",
                        "repeating_loc_material",
                        "repeating_loc_b",
                        "repeating_loc_e",
                        "repeating_loc_p",
                        "repeating_loc_f",
                        "repeating_loc_piece_wt",
                        "repeating_loc_ecn",
                        "bodysize"
                        ], function(values) {
                            //console.log("type: " + values.repeating_loc_piecetype);
                            var locs = values.repeating_loc_piecetype.split(",");
                            var mats = values.repeating_loc_material.split(",");
                            var matType = mats[4];
                            var locType = locs[16];
                            var wMultiplier = Number(values.bodysize)-6;
                            
                            //console.log("=========================original weight: "+defaultW);
                            //console.log("=========================multiplier: "+((100+(wMultiplier*10))/100));

                            var adjWeight = Math.round((weightMatrix[matType][locType]*((100+(wMultiplier*10))/100))*10)/10;
                            //console.log("=========================final weight: "+adjWeight);
                            setAttrs({
                                        repeating_loc_piece_wt: adjWeight
                                    });
                            if(values.repeating_loc_ecn == 'n')
                                {   setAttrs({
                                        repeating_loc_piece_weight: 0,
                                    });
                                    TAS.repeatingSimpleSum('loc','piece_weight','armour_wt_h');
                                     for (var n=0; n<(locs.length-1); n++)
                                        {
                                            setAttrs({
                                                ["repeating_loc_impact_b_"+[n]]: 0,
                                                ["repeating_loc_impact_e_"+[n]]: 0,
                                                ["repeating_loc_impact_p_"+[n]]: 0,
                                                ["repeating_loc_impact_f_"+[n]]: 0
                                            });
                                        TAS.repeatingSimpleSum('loc','impact_b_'+[n],'armour_b_h_'+[n]);
                                        TAS.repeatingSimpleSum('loc','impact_e_'+[n],'armour_e_h_'+[n]);
                                        TAS.repeatingSimpleSum('loc','impact_p_'+[n],'armour_p_h_'+[n]);
                                        TAS.repeatingSimpleSum('loc','impact_f_'+[n],'armour_f_h_'+[n]);
                                        }
                                }
                            else if(values.repeating_loc_ecn == 'c' || values.repeating_loc_ecn == 'e')
                            {
                                setAttrs({
                                    repeating_loc_piece_weight: values.repeating_loc_piece_wt
                                });
                                TAS.repeatingSimpleSum('loc','piece_weight','armour_wt_h');

                                    for (var n=0; n<(locs.length-1); n++)
                                    {
                                        if(locs[n] == '1' && values.repeating_loc_ecn == 'e')
                                        {   setAttrs({
                                                ["repeating_loc_impact_b_"+[n]]: values.repeating_loc_b,
                                                ["repeating_loc_impact_e_"+[n]]: values.repeating_loc_e,
                                                ["repeating_loc_impact_p_"+[n]]: values.repeating_loc_p,
                                                ["repeating_loc_impact_f_"+[n]]: values.repeating_loc_f
                                            });
                                        }
                                        else
                                        {
                                            setAttrs({
                                                ["repeating_loc_impact_b_"+[n]]: 0,
                                                ["repeating_loc_impact_e_"+[n]]: 0,
                                                ["repeating_loc_impact_p_"+[n]]: 0,
                                                ["repeating_loc_impact_f_"+[n]]: 0
                                            });
                                        }
                                        TAS.repeatingSimpleSum('loc','impact_b_'+[n],'armour_b_h_'+[n]);
                                        TAS.repeatingSimpleSum('loc','impact_e_'+[n],'armour_e_h_'+[n]);
                                        TAS.repeatingSimpleSum('loc','impact_p_'+[n],'armour_p_h_'+[n]);
                                        TAS.repeatingSimpleSum('loc','impact_f_'+[n],'armour_f_h_'+[n]);
                                    }
                                
                            }
                            
                    });
                    
            });

             on('change:repeating_Weapons:weapon_WGT_rep change:repeating_Weapons:weapon_equipped remove:repeating_Weapons',function(){
                  getAttrs(["repeating_Weapons_weapon_WGT_rep", "repeating_Weapons_weapon_equipped"], function(values) {
                            //console.log("type: " + values.repeating_loc_piecetype);
                            if(values.repeating_Weapons_weapon_equipped == 'n')
                            {
                                setAttrs({
                                        repeating_Weapons_weapon_piece_weight: 0,
                                    });
                                
                            }
                            else
                            {
                                setAttrs({
                                        repeating_Weapons_weapon_piece_weight: values.repeating_Weapons_weapon_WGT_rep,
                                    });
                            }
                            TAS.repeatingSimpleSum('Weapons','weapon_piece_weight', 'weapons_tot_h');
                    
                });
            });

            on('change:repeating_equipment:item_weight change:repeating_equipment:item_equipped remove:repeating_equipment',function(){
                  getAttrs(["repeating_equipment_item_weight", "repeating_equipment_item_equipped"], function(values) {
                            //console.log("type: " + values.repeating_loc_piecetype);
                            if(values.repeating_equipment_item_equipped == 'n')
                            {
                                setAttrs({
                                        repeating_equipment_item_wt: 0,
                                    });
                                
                            }
                            else
                            {
                                setAttrs({
                                        repeating_equipment_item_wt: values.repeating_equipment_item_weight,
                                    });
                            }
                            TAS.repeatingSimpleSum('equipment','item_wt', 'gen_equip_wt_h');
                    
                });
            });
            on('change:repeating_injuries:inj_lvl remove:repeating_injuries',function(){
                 TAS.repeatingSimpleSum('injuries','inj_lvl', 'inj_tot_h');
                    
            });
            on('change:repeating_horses:breed remove:repeating_horses',function(){
                 getAttrs(["repeating_horses_breed"], function(values) {
                            var horsestats = values.repeating_horses_breed.split(",");
                            
                    setAttrs({
                            repeating_horses_horse_load_h: horsestats[0],
                            repeating_horses_horse_str_h: horsestats[1],
                            repeating_horses_horse_sta_h: horsestats[2],
                            repeating_horses_horse_agl_h: horsestats[3],
                            repeating_horses_horse_eye_h: horsestats[4],
                            repeating_horses_horse_hrg_h: horsestats[5],
                            repeating_horses_horse_sml_h: horsestats[6],
                            repeating_horses_horse_int_h: horsestats[7],
                            repeating_horses_horse_aur_h: horsestats[8],
                            repeating_horses_horse_wil_h: horsestats[9],
                            repeating_horses_horse_ini: horsestats[10],
                            repeating_horses_horse_end_h: horsestats[11],
                            repeating_horses_horse_mov_h: horsestats[12],
                            repeating_horses_horse_dge_h: horsestats[13],
                            repeating_horses_horse_tra: horsestats[14],
                            repeating_horses_horse_dam_h: horsestats[15],
                            repeating_horses_horse_aw_h: horsestats[16]
                        });
          
                });
                    
            });
            //* Sunsign *//
            on('change:month change:day',function(){
                 getAttrs(["Month", "Day", "CS2ml", "CS3ml", "climbingml", "jumpingml", "stealthml", "tml", "awarenessml", "Intrigueml", "Rhetoricml", "Oratoryml", "Singingml", "shpv1ml", "shpv2ml", "shpv3ml", "shpv4ml", "shpv5ml", "shpv6ml"], function(values) {
                    var m = parseInt(values.Month);
                    var d = parseInt(values.Day);
                    var ss = "0,0,0,0,0,0,0,0,0,0,0,0";
                    var tempml;
                    var sunsignName = "";
                    switch(m){
                        case 1:
                            if(d <= 2){
                                ss = "1,0,0,0,0,0,0,0,0,0,0,1";
                                sunsignName = "Lad/Ula";
                            }else if(d >= 4 && d <=28){
                                ss = "1,0,0,0,0,0,0,0,0,0,0,0";
                                sunsignName = "Ula";
                            }else if(d == 3){
                                ss = "0,0,0,0,0,0,0,0,0,0,0,1";
                                sunsignName = "Lad";
                            }else{
                                ss = "1,1,0,0,0,0,0,0,0,0,0,0";
                                sunsignName = "Ula/Ara";
                            }
                            break;
                        case 2:
                            if(d <= 2){
                                ss = "1,1,0,0,0,0,0,0,0,0,0,0";
                                sunsignName = "Ula/Ara";
                            }else if(d >= 4 && d <=28){
                                ss = "0,1,0,0,0,0,0,0,0,0,0,0";
                                sunsignName = "Ara";
                            }else if(d == 3){
                                ss = "1,0,0,0,0,0,0,0,0,0,0,0";
                                sunsignName = "Ula";
                            }else{
                                ss = "0,1,1,0,0,0,0,0,0,0,0,0";
                                sunsignName = "Ara/Fen";
                            }
                            break;
                        case 3:
                            if(d <= 2){
                                ss = "0,1,1,0,0,0,0,0,0,0,0,0";
                                sunsignName = "Ara/Fen";
                            }else if(d >= 3 && d <=28){
                                ss = "0,0,1,0,0,0,0,0,0,0,0,0";
                                sunsignName = "Fen";
                            }else{
                                ss = "0,0,1,1,0,0,0,0,0,0,0,0";
                                sunsignName = "Fen/Ahn";
                            }
                            break;
                        case 4:
                            if(d <= 2){
                                ss = "0,0,1,1,0,0,0,0,0,0,0,0";
                                sunsignName = "Fen/Ahn";
                            }else if(d >= 4 && d <=28){
                                ss = "0,0,0,1,0,0,0,0,0,0,0,0";
                                sunsignName = "Ahn";
                            }else if(d == 3){
                                ss = "0,0,1,0,0,0,0,0,0,0,0,0";
                                sunsignName = "Fen";
                            }else{
                                ss = "0,0,0,1,1,0,0,0,0,0,0,0";
                                sunsignName = "Ahn/Ang";
                            }
                            break;
                        case 5:
                            if(d <= 2){
                                ss = "0,0,0,1,1,0,0,0,0,0,0,0";
                                sunsignName = "Ahn/Ang";
                            }else if(d >= 5 && d <=28){
                                ss = "0,0,0,0,1,0,0,0,0,0,0,0";
                                sunsignName = "Ang";
                            }else if(d > 2 && d < 5){
                                ss = "0,0,0,1,0,0,0,0,0,0,0,0";
                                sunsignName = "Ahn";
                            }else{
                                ss = "0,0,0,0,1,1,0,0,0,0,0,0";
                                sunsignName = "Ang/Nad";
                            }
                            break;
                        case 6:
                            if(d <= 2){
                                ss = "0,0,0,0,1,1,0,0,0,0,0,0";
                                sunsignName = "Ang/Nad";
                            }else if(d >= 7 && d <=28){
                                ss = "0,0,0,0,0,1,0,0,0,0,0,0";
                                sunsignName = "Nad";
                            }else if(d > 2 && d < 7){
                                ss = "0,0,0,0,1,0,0,0,0,0,0,0";
                                sunsignName = "Ang";
                            }else{
                                ss = "0,0,0,0,0,1,1,0,0,0,0,0";
                                sunsignName = "Nad/Hir";
                            }
                        break;
                        case 7:
                            if(d <= 2){
                                ss = "0,0,0,0,0,1,1,0,0,0,0,0";
                                sunsignName = "Nad/Hir";
                            }else if(d >= 6 && d <=28){
                                ss = "0,0,0,0,0,0,1,0,0,0,0,0";
                                sunsignName = "Hir";
                            }else if(d > 2 && d < 6){
                                ss = "0,0,0,0,0,1,0,0,0,0,0,0";
                                sunsignName = "Nad";
                            }else{
                                ss = "0,0,0,0,0,0,1,1,0,0,0,0";
                                sunsignName = "Hir/Tar";
                            }
                        break;
                        case 8:
                            if(d <= 2){
                                ss = "0,0,0,0,0,0,1,1,0,0,0,0";
                                sunsignName = "Hir/Tar";
                            }else if(d >= 5 && d <=28){
                                ss = "0,0,0,0,0,0,0,1,0,0,0,0";
                                sunsignName = "Tar";
                            }else if(d > 2 && d < 5){
                                ss = "0,0,0,0,0,0,1,0,0,0,0,0";
                                sunsignName = "Hir";
                            }else{
                                ss = "0,0,0,0,0,0,0,1,1,0,0,0";
                                sunsignName = "Tar/Tai";
                            }
                        break;
                        case 9:
                            if(d <= 2){
                                ss = "0,0,0,0,0,0,0,1,1,0,0,0";
                                sunsignName = "Tar/Tai";
                            }else if(d >= 4 && d <=28){
                                ss = "0,0,0,0,0,0,0,0,1,0,0,0";
                                sunsignName = "Tai";
                            }else if(d == 3){
                                ss = "0,0,0,0,0,0,0,1,0,0,0,0";
                                sunsignName = "Tar";
                            }else{
                                ss = "0,0,0,0,0,0,0,0,1,1,0,0";
                                sunsignName = "Tai/Sko";
                            }
                        break;
                        case 10:
                            if(d <= 2){
                                ss = "0,0,0,0,0,0,0,0,1,1,0,0";
                                sunsignName = "Tai/Sko";
                            }else if(d >= 3 && d <=28){
                                ss = "0,0,0,0,0,0,0,0,0,1,0,0";
                                sunsignName = "Sko";
                            }else{
                                ss = "0,0,0,0,0,0,0,0,0,1,1,0";
                                sunsignName = "Sko/Mas";
                            }
                        break;
                        case 11:
                            if(d <= 2){
                                ss = "0,0,0,0,0,0,0,0,0,1,1,0";
                                sunsignName = "Sko/Mas";
                            }else if(d >= 3 && d <=28){
                                ss = "0,0,0,0,0,0,0,0,0,0,1,0";
                                sunsignName = "Mas";
                            }else{
                                ss = "0,0,0,0,0,0,0,0,0,0,1,1";
                                sunsignName = "Mas/Lad";
                            }
                        break;
                        case 12:
                            if(d <= 2){
                                ss = "0,0,0,0,0,0,0,0,0,0,1,1";
                                sunsignName = "Mas/Lad";
                            }else if(d >= 3 && d <=28){
                                ss = "0,0,0,0,0,0,0,0,0,0,0,1";
                                sunsignName = "Lad";
                            }else{
                                ss = "1,0,0,0,0,0,0,0,0,0,0,1";
                                sunsignName = "Lad/Ula";
                            }
                    }
                    setAttrs({
                            sunsign_h: sunsignName,
                            sunsigntable_h: ss
                        });
                    var sign = ss.split(",");

                    var a = parseInt(sign[0])*1;
                    var b = parseInt(sign[11])*1;
                    var x = Math.max(a,b);
                    var tempml = values.CS2ml;
                    if(tempml<5)
                        tempml = 5;
                    setAttrs({
                            CS2ss_h: x,
                            CS2ml: tempml
                    });
                    var a = parseInt(sign[0])*1;
                    var b = parseInt(sign[1])*1;
                    var x = Math.max(a,b);
                    var tempml = values.CS3ml;
                    if(tempml<1)
                        tempml = 1;
                    setAttrs({
                            CS3ss_h: x,
                            CS3ml: tempml
                    });
                    var a = parseInt(sign[0])*2;
                    var b = parseInt(sign[1])*2;
                    var x = Math.max(a,b);
                    var tempml = values.climbingml;
                    if(tempml<4)
                        tempml = 4;
                    setAttrs({
                            climbingss_h: x,
                            climbingml: tempml
                    });
                    var a = parseInt(sign[5])*2;
                    var b = parseInt(sign[6])*2;
                    var x = Math.max(a,b);
                    var tempml = values.jumpingml;
                    if(tempml<4)
                        tempml = 4;
                    setAttrs({
                            jumpingss_h: x,
                            jumpingml: tempml
                    });
                    var a = parseInt(sign[6])*2;
                    var b = parseInt(sign[7])*2;
                    var c = parseInt(sign[8])*2;
                    var x = Math.max(a,b,c);
                    var tempml = values.stealthml;
                    if(tempml<3)
                        tempml = 3;
                    setAttrs({
                            stealthss_h: x,
                            stealthml: tempml
                    });
                    var a = parseInt(sign[6])*2;
                    var b = parseInt(sign[5])*1;
                    var c = parseInt(sign[7])*1;
                    var x = Math.max(a,b,c);
                    var tempml = values.tml;
                    if(tempml<4)
                        tempml = 4;
                    setAttrs({
                            throwingss_h: x,
                            tml: tempml
                    });
                    var a = parseInt(sign[6])*2;
                    var b = parseInt(sign[7])*2;
                    var x = Math.max(a,b);
                    var tempml = values.awarenessml;
                    if(tempml<4)
                        tempml = 4;
                    setAttrs({
                            awarenessss_h: x,
                            awarenessml: tempml
                    });
                    var a = parseInt(sign[7])*1;
                    var b = parseInt(sign[8])*1;
                    var c = parseInt(sign[9])*1;
                    var x = Math.max(a,b,c);
                    var tempml = values.Intrigueml;
                    if(tempml<3)
                        tempml = 3;
                    setAttrs({
                            intriguess_h: x,
                            rhetoricss_h: x,
                            Intrigueml: tempml
                    });
                    var tempml = values.Rhetoricml;
                    if(tempml<3)
                        tempml = 3;
                    setAttrs({
                            Rhetoricml: tempml
                    });
                    var x = parseInt(sign[7])*1;
                    var tempml = values.Oratoryml;
                    if(tempml<2)
                        tempml = 2;
                    setAttrs({
                            oratoryss_h: x,
                            Oratoryml: tempml
                    });
                    var x = parseInt(sign[10])*1;
                    var tempml = values.Singingml;
                    if(tempml<3)
                        tempml = 3;
                    setAttrs({
                            singingss_h: x,
                            Singingml: tempml
                    });
                    calcSkill("lyahvi", "shpv1sb", "lyahviss_h", "shpv1ml", values.shpv1ml);
                    calcSkill("peleahn", "shpv2sb", "peleahnss_h", "shpv2ml", values.shpv2ml);
                    calcSkill("jmorvi", "shpv3sb", "jmorviss_h", "shpv3ml", values.shpv3ml); 
                    calcSkill("fyvria", "shpv4sb", "fyvriass_h", "shpv4ml", values.shpv4ml);
                    calcSkill("odishve", "shpv5sb", "odishvess_h", "shpv5ml", values.shpv5ml);
                    calcSkill("savorya", "shpv6sb", "savoryass_h", "shpv6ml", values.shpv6ml);
                });
                    
            });

            const getRows = function (prefix) {
                const sourceAttrs = [
                    prefix, prefix+"ml",
                ];
                getAttrs(sourceAttrs, function (v) {
                    //console.log("Skill = " + prefix);
                    var SN = v[prefix];
                    //console.log("Skill Name = " + SN);
                    var SML = v[prefix+"ml"];
                    //console.log("Skill ML = " + SML);
                    calcSkill(SN, prefix+"sb", prefix+"ss_h", prefix+"ml", SML);
                    var SN = "";
                    var SML = 0;
                });
            };
            const getWeaponRows = function (prefix) {
                const sourceAttrs = [
                    prefix+"class_rep", prefix+"ML_rep",
                ];
                getAttrs(sourceAttrs, function (v) {
                    console.log("Skill = " + prefix);
                    var SN = v[prefix+"class_rep"];
                    console.log("Skill Name = " + SN);
                    var SML = v[prefix+"ML_rep"];
                    console.log("Skill ML = " + SML);
                    calcSkill(SN, prefix+"Skill_rep", prefix+"SS_rep_h", prefix+"ML_rep", SML);
                    var SN = "";
                    var SML = 0;
                });
            };


        on('change:strength change:stamina change:dexterity change:agility change:eyesight change:hearing change:smell change:voice change:intelligence change:will change:aura change:comeliness change:sunsigntable_h', function () {
            getAttrs(["CS3ml"], function(values) {
                calcSkill("riding", "CS3sb", "CS3ss_h", "CS3ml", values.CS3ml);
            });
            getAttrs(["crafta", "craftaml"], function(values) {
                calcSkill(values.crafta, "craftasb", "craftass_h", "craftaml", values.craftaml);
            });
            getAttrs(["craftb", "craftbml"], function(values) {
                calcSkill(values.crafta, "craftbsb", "craftbss_h", "craftbml", values.craftaml);
            });
            getAttrs(["langa", "langaml"], function(values) {
                calcSkill(values.langa, "langasb", "langass_h", "langaml", values.langaml);
            });
            getAttrs(["langb", "langbml"], function(values) {
                calcSkill(values.langb, "langbsb", "langbss_h", "langbml", values.langbml);
            });
            getSectionIDs('repeating_combat', function (ids) {
                ids.forEach(id => getRows('repeating_combat_'+id+"_cs4"));
                ids.forEach(id => getRows('repeating_combat_'+id+"_cs5"));
            });
            getSectionIDs('repeating_physical', function (ids) {
                ids.forEach(id => getRows('repeating_physical_'+id+"_ps1"));
                ids.forEach(id => getRows('repeating_physical_'+id+"_ps2"));
            });
            getSectionIDs('repeating_communication', function (ids) {
                ids.forEach(id => getRows('repeating_communication_'+id+"_comm1"));
                ids.forEach(id => getRows('repeating_communication_'+id+"_comm2"));
            });
            getSectionIDs('repeating_craft', function (ids) {
                ids.forEach(id => getRows('repeating_craft_'+id+"_craft1"));
                ids.forEach(id => getRows('repeating_craft_'+id+"_craft2"));
            });
            getSectionIDs('repeating_lang', function (ids) {
                ids.forEach(id => getRows('repeating_lang_'+id+"_lang1"));
                ids.forEach(id => getRows('repeating_craft_'+id+"_lang2"));
            });
            getSectionIDs('repeating_Weapons', function (ids) {
                ids.forEach(id => getWeaponRows('repeating_Weapons_'+id+"_weapon_"));
            });

        });


            on('change:repeating_combat:cs4',function(){
                getAttrs(["repeating_combat_cs4", "repeating_combat_cs4ml"], function(values) {
                    calcSkill(values.repeating_combat_cs4, "repeating_combat_cs4sb", "repeating_combat_cs4ss_h", "repeating_combat_cs4ml", values.repeating_combat_cs4ml); 
                });
            });
            on('change:repeating_combat:cs5',function(){
                getAttrs(["repeating_combat_cs5", "repeating_combat_cs5ml"], function(values) {
                    calcSkill(values.repeating_combat_cs5, "repeating_combat_cs5sb", "repeating_combat_cs5ss_h", "repeating_combat_cs5ml", values.repeating_combat_cs5ml);
                });
            });
            on('change:repeating_physical:ps1',function(){
                getAttrs(["repeating_physical_ps1", "repeating_physical_ps1ml"], function(values) {
                    calcSkill(values.repeating_physical_ps1, "repeating_physical_ps1sb", "repeating_physical_ps1ss_h", "repeating_physical_ps1ml", values.repeating_physical_ps1ml);
                });
            });
            on('change:repeating_physical:ps2',function(){
                getAttrs(["repeating_physical_ps2", "repeating_physical_ps2ml"], function(values) {
                    calcSkill(values.repeating_physical_ps2, "repeating_physical_ps2sb", "repeating_physical_ps2ss_h", "repeating_physical_ps2ml", values.repeating_physical_ps2ml);
                });
            });
            on('change:repeating_communication:comm1',function(){
                getAttrs(["repeating_communication_comm1", "repeating_communication_comm1ml"], function(values) {
                    calcSkill(values.repeating_communication_comm1, "repeating_communication_comm1sb", "repeating_communication_comm1ss_h", "repeating_communication_comm1ml", values.repeating_communication_comm1ml);
                });
            });
            on('change:repeating_communication:comm2',function(){
                getAttrs(["repeating_communication_comm2", "repeating_communication_comm2ml"], function(values) {
                    calcSkill(values.repeating_communication_comm2, "repeating_communication_comm2sb", "repeating_communication_comm2ss_h", "repeating_communication_comm2ml", values.repeating_communication_comm2ml);
                });
            });
            on('change:crafta',function(){
                getAttrs(["crafta", "craftaml"], function(values) {
                    calcSkill(values.crafta, "craftasb", "craftass_h", "craftaml", values.craftaml);
                });
            });
            on('change:rtl',function(){
                getAttrs(["rtl", "Ritualml"], function(values) {
                    calcSkill(values.rtl, "Ritualsb", "ritualss_h", "Ritualml", values.Ritualml);
                });
            });
            on('change:craftb',function(){
                getAttrs(["craftb", "craftbml"], function(values) {
                    calcSkill(values.craftb, "craftbsb", "craftbss_h", "craftbml", values.craftbml);
                });
            });
            on('change:repeating_craft:craft1',function(){
                getAttrs(["repeating_craft_craft1", "repeating_craft_craft1ml"], function(values) {
                    calcSkill(values.repeating_craft_craft1, "repeating_craft_craft1sb", "repeating_craft_craft1ss_h", "repeating_craft_craft1ml", values.repeating_craft_craft1ml);
                });
            });
            on('change:repeating_craft:craft2',function(){
                getAttrs(["repeating_craft_craft2", "repeating_craft_craft2ml"], function(values) {
                    calcSkill(values.repeating_craft_craft2, "repeating_craft_craft2sb", "repeating_craft_craft2ss_h", "repeating_craft_craft2ml", values.repeating_craft_craft2ml);
                });
            });
            on('change:langa',function(){
                getAttrs(["langa", "langaaml"], function(values) {
                    calcSkill(values.langa, "langasb", "langass_h", "langaaml", values.langaaml);
                });
            });
            on('change:langb',function(){
                getAttrs(["langb", "langbml"], function(values) {
                    calcSkill(values.langb, "langbsb", "langbss_h", "langbml", values.langbml);
                });
            });
            on('change:repeating_lang:lang1',function(){
                getAttrs(["repeating_lang_lang1", "repeating_lang_lang1ml"], function(values) {
                    calcSkill(values.repeating_lang_lang1, "repeating_lang_lang1sb", "repeating_lang_lang1ss_h", "repeating_lang_lang1ml", values.repeating_lang_lang1ml);
                });
            });
            on('change:repeating_lang:lang2',function(){
                getAttrs(["repeating_lang_lang2", "repeating_lang_lang2ml"], function(values) {
                    calcSkill(values.repeating_lang_lang2, "repeating_lang_lang2sb", "repeating_lang_lang2ss_h", "repeating_lang_lang2ml", values.repeating_lang_lang2ml);
                });
            });
            on('change:repeating_weapons:weapon_class_rep',function(){
                getAttrs(["repeating_Weapons_weapon_class_rep", "repeating_Weapons_weapon_ML_rep", "repeating_Weapons_weapon_Skill_rep", "repeating_Weapons_weapon_SS_rep_h"], function(values) {
                    calcSkill(values.repeating_Weapons_weapon_class_rep, "repeating_Weapons_weapon_Skill_rep", "repeating_Weapons_weapon_SS_rep_h", "repeating_Weapons_weapon_ML_rep", values.repeating_Weapons_weapon_ML_rep);
                });
            });
            on('change:repeating_weapons:weapon_name_rep',function(){
                getAttrs(["repeating_Weapons_weapon_name_rep"], function(values) {
                    calcWStats(values.repeating_Weapons_weapon_name_rep);
                });
            });

            on('change:repeating_lyahvi:lyahvi_mem remove:repeating_lyahvi',function(){
                getAttrs(["repeating_lyahvi_spri1lvas", "repeating_lyahvi_lyahvi_mem"], function(values) {
                    if(values.repeating_lyahvi_lyahvi_mem == '1')
                            {
                                setAttrs({

                                    repeating_lyahvi_lyahvi_lvl: values.repeating_lyahvi_spri1lvas
                                });
                            }
                    else{
                        setAttrs({

                                    repeating_lyahvi_lyahvi_lvl: 0
                                });
                        
                    }
                    TAS.repeatingSimpleSum('lyahvi','lyahvi_lvl', 'tot_mem_spells_1h');
                 });   
            });
            on('change:repeating_peleahn:peleahn_mem remove:repeating_peleahn',function(){
                getAttrs(["repeating_peleahn_spri2lvas", "repeating_peleahn_peleahn_mem"], function(values) {
                    if(values.repeating_peleahn_peleahn_mem == '1')
                            {
                                setAttrs({

                                    repeating_peleahn_peleahn_lvl: values.repeating_peleahn_spri2lvas
                                });
                            }
                    else{
                        setAttrs({

                                    repeating_peleahn_peleahn_lvl: 0
                                });
                        
                    }
                    TAS.repeatingSimpleSum('peleahn','peleahn_lvl', 'tot_mem_spells_2h');
                 });   
            });
            on('change:repeating_jmorvi:jmorvi_mem remove:repeating_jmorvi',function(){
                getAttrs(["repeating_jmorvi_spri3lvas", "repeating_jmorvi_jmorvi_mem"], function(values) {
                    if(values.repeating_jmorvi_jmorvi_mem == '1')
                            {
                                setAttrs({

                                    repeating_jmorvi_jmorvi_lvl: values.repeating_jmorvi_spri3lvas
                                });
                            }
                    else{
                        setAttrs({

                                    repeating_jmorvi_jmorvi_lvl: 0
                                });
                        
                    }
                    TAS.repeatingSimpleSum('jmorvi','jmorvi_lvl', 'tot_mem_spells_3h');
                 });   
            });
            on('change:repeating_fyvria:fyvria_mem remove:repeating_fyvria',function(){
                getAttrs(["repeating_fyvria_spri4lvas", "repeating_fyvria_fyvria_mem"], function(values) {
                    if(values.repeating_fyvria_fyvria_mem == '1')
                            {
                                setAttrs({

                                    repeating_fyvria_fyvria_lvl: values.repeating_fyvria_spri4lvas
                                });
                            }
                    else{
                        setAttrs({

                                    repeating_fyvria_fyvria_lvl: 0
                                });
                        
                    }
                    TAS.repeatingSimpleSum('fyvria','fyvria_lvl', 'tot_mem_spells_4h');
                 });   
            });
            on('change:repeating_odivshe:odivshe_mem remove:repeating_odivshe',function(){
                getAttrs(["repeating_odivshe_spri5lvas", "repeating_odivshe_odivshe_mem"], function(values) {
                    if(values.repeating_odivshe_odivshe_mem == '1')
                            {
                                setAttrs({

                                    repeating_odivshe_odivshe_lvl: values.repeating_odivshe_spri5lvas
                                });
                            }
                    else{
                        setAttrs({

                                    repeating_odivshe_odivshe_lvl: 0
                                });
                        
                    }
                    TAS.repeatingSimpleSum('odivshe','odivshe_lvl', 'tot_mem_spells_5h');
                 });   
            });
            on('change:repeating_savorya:savorya_mem remove:repeating_savorya',function(){
                getAttrs(["repeating_savorya_spri6lvas", "repeating_savorya_savorya_mem"], function(values) {
                    if(values.repeating_savorya_savorya_mem == '1')
                            {
                                setAttrs({

                                    repeating_savorya_savorya_lvl: values.repeating_savorya_spri6lvas
                                });
                            }
                    else{
                        setAttrs({

                                    repeating_savorya_savorya_lvl: 0
                                });
                        
                    }
                    TAS.repeatingSimpleSum('savorya','savorya_lvl', 'tot_mem_spells_6h');
                 });   
            });
            on('change:repeating_neutral:neutral_mem remove:repeating_neutral',function(){
                getAttrs(["repeating_neutral_spri7lvas", "repeating_neutral_neutral_mem"], function(values) {
                    if(values.repeating_neutral_neutral_mem == '1')
                            {
                                setAttrs({

                                    repeating_neutral_neutral_lvl: values.repeating_neutral_spri7lvas
                                });
                            }
                    else{
                        setAttrs({

                                    repeating_neutral_neutral_lvl: 0
                                });
                        
                    }
                    TAS.repeatingSimpleSum('neutral','neutral_lvl', 'tot_mem_spells_7h');
                 });   
            });
            on('change:repeating_ritual:ritual_mem remove:repeating_ritual',function(){
                getAttrs(["repeating_ritual_spri8lvas", "repeating_ritual_ritual_mem"], function(values) {
                    if(values.repeating_ritual_ritual_mem == '1')
                            {
                                setAttrs({

                                    repeating_ritual_ritual_lvl: values.repeating_ritual_spri8lvas
                                });
                            }
                    else{
                        setAttrs({

                                    repeating_ritual_ritual_lvl: 0
                                });
                        
                    }
                    TAS.repeatingSimpleSum('ritual','ritual_lvl', 'tot_mem_spells_8h');
                 });   
            });
            </script>


        <rolltemplate class="sheet-rolltemplate-harn">
            
                {{#lya}}
                    <table><tr><th class="lya">{{lya}}</th></tr></table>
                {{/lya}}
                {{#pel}}
                   <table><tr><th class="pel">{{pel}}</th></tr></table>
                {{/pel}}
                {{#fyv}}
                    <table><tr><th class="fyv">{{fyv}}</th></tr></table>
                {{/fyv}}
                {{#jmo}}
                    <table><tr><th class="jmo">{{jmo}}</th></tr></table>
                {{/jmo}}
                {{#odi}}
                    <table><tr><th class="odi">{{odi}}</th></tr></table>
                {{/odi}}
                {{#sav}}
                    <table><tr><th class="sav">{{sav}}</th></tr></table>
                {{/sav}}
                {{#neu}}
                    <table><tr><th class="neu">{{neu}}</th></tr></table>
                {{/neu}}
                {{#rit}}
                    <table><tr><th class="rit">{{rit}}</th></tr></table>
                {{/rit}}
                {{#weapon}}
                    <table><tr><th class="weapon">{{weapon}}</th></tr></table>
                {{/weapon}}
                {{#skill}}
                    <table><tr><th class="skill">{{skill}}</th></tr></table>
                {{/skill}}
                {{#roll}}
                    <table><tr><td><span class="roll">Roll: <b>{{roll}}</b> vs EML {{eml}} [send to player](!&#13;/w {{who}} Roll: <b>{{roll}}</b> vs EML {{eml}})</span></td></tr></table>
                {{/roll}}
                {{#spellroll}}
                    <table><tr><td><span class="roll">Roll: <b>{{spellroll}}</b> vs EML {{spelleml}}</span></td></tr></table>
                {{/spellroll}}    
                        {{#cf}}
                        <table><tr><td><span class="cf">{{cf}}</span></td></tr></table>
                        {{/cf}}
                        {{#mf}}
                        <table><tr><td><span class="mf">{{mf}}</span></td></tr></table>
                        {{/mf}}
                        {{#ms}}
                        <table><tr><td><span class="ms">{{ms}}</span></td></tr></table>
                        {{/ms}}
                        {{#cs}}
                        <table><tr><td><span class="cs">{{cs}}</span></td></tr></table>
                        {{/cs}}
                {{#spellfailure}}
                    <table><tr><td class="neu">{{spellfailure}}</td></tr></table>
                {{/spellfailure}}
        </rolltemplate>
                
        <!--EML eml roll type skill skillclass-->
